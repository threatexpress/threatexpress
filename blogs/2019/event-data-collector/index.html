



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Threatexpress Blog">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.2">
    
    
      
        <title>Event Data Collector - Threatexpress</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.982221ab.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../../assets/javascripts/modernizr.1f0bcf2b.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="black" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#event-data-collector-edc" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../.." title="Threatexpress" class="md-header-nav__button md-logo">
          
            <img src="../../../img/threatexpress_logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Threatexpress
            </span>
            <span class="md-header-nav__topic">
              Event Data Collector
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/threatexpress/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    threatexpress/threatexpress
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../.." title="Threatexpress" class="md-nav__button md-logo">
      
        <img src="../../../img/threatexpress_logo.png" width="48" height="48">
      
    </a>
    Threatexpress
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/threatexpress/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    threatexpress/threatexpress
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Posts
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Posts
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1" checked>
    
    <label class="md-nav__link" for="nav-2-1">
      2019
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        2019
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Event Data Collector
      </label>
    
    <a href="./" title="Event Data Collector" class="md-nav__link md-nav__link--active">
      Event Data Collector
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#general-information" title="General Information" class="md-nav__link">
    General Information
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#views" title="Views" class="md-nav__link">
    Views
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#urls" title="URLs" class="md-nav__link">
    URLs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rest-framework" title="Rest Framework" class="md-nav__link">
    Rest Framework
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authentication-and-authorization" title="Authentication and Authorization" class="md-nav__link">
    Authentication and Authorization
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#roles-groups" title="Roles (Groups)" class="md-nav__link">
    Roles (Groups)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#role-permissions" title="Role Permissions" class="md-nav__link">
    Role Permissions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accounts" title="Accounts" class="md-nav__link">
    Accounts
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#account-permissions" title="Account Permissions" class="md-nav__link">
    Account Permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2fa" title="2FA" class="md-nav__link">
    2FA
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consolidated-security-information" title="Consolidated Security Information" class="md-nav__link">
    Consolidated Security Information
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quick-tips" title="Quick Tips" class="md-nav__link">
    Quick Tips
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use" title="Use" class="md-nav__link">
    Use
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../c2-agent-comparison/" title="C2 Agent Comparison" class="md-nav__link">
      C2 Agent Comparison
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../git-clone-entire-org/" title="Git clone all organizational repos" class="md-nav__link">
      Git clone all organizational repos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../penetration-testing-pasties/" title="Penetration Testing Pasties" class="md-nav__link">
      Penetration Testing Pasties
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      2018
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        2018
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../2018/a-deep-dive-into-cobalt-strike-malleable-c2/" title="A Deep Dive into Cobalt Strike Malleable C2" class="md-nav__link">
      A Deep Dive into Cobalt Strike Malleable C2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2018/threat-gets-a-vote-applying-a-threat-based-approach-to-security-testing/" title="Threat Get's a Vote - Applying a Threat-Based Approach to Security Testing" class="md-nav__link">
      Threat Get's a Vote - Applying a Threat-Based Approach to Security Testing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2018/threat-mitigation-strategies-technical-recommendations-and-info-part-2/" title="Threat Mitagation Strategies - Part 2" class="md-nav__link">
      Threat Mitagation Strategies - Part 2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2018/automating-cobalt-strike-profiles-apache-mod_rewrite-htaccess-files-intelligent-c2-redirection/" title="Automating Cobalt Strike Profiles Apache mod_rewrite htaccess Files for Intelligent C2 Redirection" class="md-nav__link">
      Automating Cobalt Strike Profiles Apache mod_rewrite htaccess Files for Intelligent C2 Redirection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2018/threat-mitigation-strategies-observations-recommendations/" title="Threat Mitagation Strategies - Part 1" class="md-nav__link">
      Threat Mitagation Strategies - Part 1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2018/hostenum-updates-usage/" title="HostEnum - Updates and Usage Guide" class="md-nav__link">
      HostEnum - Updates and Usage Guide
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      2017
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        2017
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../2017/metatwin-borrowing-microsoft-metadata-and-digital-signatures-to-hide-binaries/" title="Borrowing Microsoft MetaData and Signatures to Hide Binary Payloads" class="md-nav__link">
      Borrowing Microsoft MetaData and Signatures to Hide Binary Payloads
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2017/install-bloodhound-ubuntu/" title="Install BloodHound on Ubuntu" class="md-nav__link">
      Install BloodHound on Ubuntu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2017/empire-modifying-server-c2-indicators/" title="Empire Modifying Server C2 Indicators" class="md-nav__link">
      Empire Modifying Server C2 Indicators
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2017/invoke-hostenum/" title="Invoke-Hostenum" class="md-nav__link">
      Invoke-Hostenum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2017/leveraging-expired-domains-for-red-team-engagements/" title="Leveraging Expired Domains for Red Team Engagements" class="md-nav__link">
      Leveraging Expired Domains for Red Team Engagements
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4">
    
    <label class="md-nav__link" for="nav-2-4">
      2016
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-4">
        2016
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../2016/slack-notifications-for-cobalt-strike/" title="Slack Notifications for Cobalt Strike" class="md-nav__link">
      Slack Notifications for Cobalt Strike
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2016/web-shells-covert-channel/" title="SubShell and TinyShell - Custom Covert Webshells" class="md-nav__link">
      SubShell and TinyShell - Custom Covert Webshells
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2016/new-information-security-red-teaming-blog-threat-express-minis/" title="New Information Security and Red Teaming Blog Threat Express by MINIS" class="md-nav__link">
      New Information Security and Red Teaming Blog Threat Express by MINIS
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Red Teaming
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Red Teaming
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../redteaming/redteaming/" title="What is Red Teaming" class="md-nav__link">
      What is Red Teaming
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../redteaming/red_vs_pen_vs_vuln/" title="Red vs Pen vs Vuln" class="md-nav__link">
      Red vs Pen vs Vuln
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../redteaming/rolesandrelationships/" title="Roles and Relationships" class="md-nav__link">
      Roles and Relationships
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../redteaming/mitre_attack/" title="Red Teaming and MITRE ATT&CK" class="md-nav__link">
      Red Teaming and MITRE ATT&CK
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../redteaming/definitions/" title="Definitions" class="md-nav__link">
      Definitions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-6" type="checkbox" id="nav-3-6">
    
    <label class="md-nav__link" for="nav-3-6">
      Red Team Planning
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-6">
        Red Team Planning
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../redteaming/redteamplanning/goalplanning/" title="Goal Planing" class="md-nav__link">
      Goal Planing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../redteaming/redteamplanning/redteamchecklist/" title="Red Team Checklist" class="md-nav__link">
      Red Team Checklist
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../redteaming/redteamplanning/roeguide/" title="Red Team ROE Guide" class="md-nav__link">
      Red Team ROE Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../redteaming/redteamplanning/tradecraft/" title="Tradecraft Guidance" class="md-nav__link">
      Tradecraft Guidance
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-7" type="checkbox" id="nav-3-7">
    
    <label class="md-nav__link" for="nav-3-7">
      Red Team IOCs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-7">
        Red Team IOCs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../redteaming/tool_ioc/tinyshell_ioc/" title="TinyShell IOCs" class="md-nav__link">
      TinyShell IOCs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../redteaming/tool_ioc/psexec/" title="PSEXEC IOCs" class="md-nav__link">
      PSEXEC IOCs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://jpcertcc.github.io/ToolAnalysisResultSheet/" title="JPCert IOCs" class="md-nav__link">
      JPCert IOCs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://digital-forensics.sans.org/media/SANS_Poster_2018_Hunt_Evil_FINAL.pdf" title="SANS Hunt Evil" class="md-nav__link">
      SANS Hunt Evil
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-8" type="checkbox" id="nav-3-8">
    
    <label class="md-nav__link" for="nav-3-8">
      Red Team Resources
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-8">
        Red Team Resources
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../redteaming/cheatsheets/" title="Cheatsheets" class="md-nav__link">
      Cheatsheets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../redteaming/resources/" title="General Resources" class="md-nav__link">
      General Resources
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../redteaming/windowsactivedirectory/" title="Attack Active Directory" class="md-nav__link">
      Attack Active Directory
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../redteaming/videos/videos/" title="Red Team Videos" class="md-nav__link">
      Red Team Videos
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../archive/" title="Post Archive" class="md-nav__link">
      Post Archive
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../contributors/" title="Contributors" class="md-nav__link">
      Contributors
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#general-information" title="General Information" class="md-nav__link">
    General Information
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#views" title="Views" class="md-nav__link">
    Views
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#urls" title="URLs" class="md-nav__link">
    URLs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rest-framework" title="Rest Framework" class="md-nav__link">
    Rest Framework
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authentication-and-authorization" title="Authentication and Authorization" class="md-nav__link">
    Authentication and Authorization
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#roles-groups" title="Roles (Groups)" class="md-nav__link">
    Roles (Groups)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#role-permissions" title="Role Permissions" class="md-nav__link">
    Role Permissions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accounts" title="Accounts" class="md-nav__link">
    Accounts
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#account-permissions" title="Account Permissions" class="md-nav__link">
    Account Permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2fa" title="2FA" class="md-nav__link">
    2FA
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consolidated-security-information" title="Consolidated Security Information" class="md-nav__link">
    Consolidated Security Information
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quick-tips" title="Quick Tips" class="md-nav__link">
    Quick Tips
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use" title="Use" class="md-nav__link">
    Use
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/threatexpress/edit/master/docs/blogs/2019/event-data-collector.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="event-data-collector-edc">EVENT DATA COLLECTOR (EDC)<a class="headerlink" href="#event-data-collector-edc" title="Permanent link">&para;</a></h1>
<p><strong><a href="https://www.twitter.com/minis_io">James Tubberville</a> | November 12, 2019 | Tweet This Post: <a href="https://twitter.com/intent/tweet?url=http://threatexpress.com/blogs/2019/event-data-collector/&amp;text=RT Event Data Collector."><i class="fa fa-twitter"></i></a></strong></p>
<p><img alt="" src="/img/edc_login.png" /></p>
<p>Event Data Collector (EDC) is a very basic django application used to capture data on the fly. </p>
<p>It is primarily designed to facilitate the flow of a cohesive red team by enabling both manual and automated collection of operational activities and information. It's not fancy, was designed in stages to meet the need of the hour, and has had some elements removed to protect multiple organizations.</p>
<p>It is expected only RT members assigned to the operation and those designated as Trusted Agents (TA), White Cell, or Control Cell members with a need-to-know will use EDC.</p>
<p>You can find all the info, code, and setup instructions on <a href="https://github.com/threatexpress/edc">Github</a>.</p>
<hr />
<h2 id="general-information">General Information<a class="headerlink" href="#general-information" title="Permanent link">&para;</a></h2>
<h4 id="views">Views<a class="headerlink" href="#views" title="Permanent link">&para;</a></h4>
<p>Views are based off templates rather than builds. This enables the team to choose what is displayed in the view and what requires viewing the entry detail.</p>
<ul>
<li>Info (info): Information about the event</li>
<li>OPLOG (oplogs) Operator Logs - Log entries of all actions</li>
<li>Targets (targets): Actioned Targets - Any target asset where actions are performed (succeed or fail)</li>
<li>Credentials (creds): Obtained Target Credentials - files, mimikatz, keylogging, etc.</li>
<li>Payloads (payloads): Location for storing pre-made payloads (escalation, c2, peristance, etc.)</li>
<li>Deconfliction (decon): Deconfliction Data - Basic data! Defensive elements (Blue Teams, SOC, etc.) side should provide more data for verified deconfliction. Note decon is just a subset of oplog data.</li>
</ul>
<p><strong>Examples:</strong></p>
<p><em>Full oplog view</em>
<img alt="" src="/img/edc_oplog.png" /></p>
<p><em>oplog command and output</em>
<img alt="" src="/img/edc_cmd_out.png" /></p>
<p><em>Targets View</em>
<img alt="" src="/img/edc_target.png" /></p>
<p><em>Credentials View</em>
<img alt="" src="/img/edc_creds.png" /></p>
<p><em>Payloads</em>
<img alt="" src="/img/edc_payload.png" /></p>
<p><em>Deconfliction</em>
<img alt="" src="/img/edc_decon.png" /></p>
<h4 id="urls">URLs<a class="headerlink" href="#urls" title="Permanent link">&para;</a></h4>
<ul>
<li>info/</li>
<li>oplogs/</li>
<li>targets/</li>
<li>creds/</li>
<li>payloads/</li>
<li>decon/</li>
<li>tag/ - quick identification of tagged logs (tag/c2, tag/observation, tag/persistence)</li>
<li>user/ - list of logs per operator (user/testerld)</li>
<li>rta/ - Admin Dashboard (change this as desired)</li>
</ul>
<h4 id="rest-framework">Rest Framework<a class="headerlink" href="#rest-framework" title="Permanent link">&para;</a></h4>
<p>(Requires IsStaff for access)</p>
<ul>
<li>eventinfo/</li>
<li>oplog/</li>
<li>cred/</li>
<li>target/</li>
<li>api-token/ &lt; Generate Key</li>
</ul>
<hr />
<h3 id="authentication-and-authorization">Authentication and Authorization<a class="headerlink" href="#authentication-and-authorization" title="Permanent link">&para;</a></h3>
<p>EDC requires an account to be assigned a role for any access. Although individual permissions can be applied, it is highly recommended to use the role based permissions.</p>
<h4 id="roles-groups">Roles (Groups)<a class="headerlink" href="#roles-groups" title="Permanent link">&para;</a></h4>
<ul>
<li>Lead: Event lead or manager - Has privileges to all edc actions</li>
<li>Operator: Operator or keyboarder - Has privileges to most edc actions less some permanent delete</li>
<li>WhiteCell: Has only view privileges for Info and Deconfliction - Trusted Agent, Observer, Data Scientist, etc.</li>
</ul>
<p><img alt="" src="/img/edc_roles.png" /></p>
<h4 id="role-permissions">Role Permissions<a class="headerlink" href="#role-permissions" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Permission</th>
<th>Lead</th>
<th>Operator</th>
<th>WhiteCell</th>
</tr>
</thead>
<tbody>
<tr>
<td>add cred</td>
<td>x</td>
<td>x</td>
<td>-</td>
</tr>
<tr>
<td>view cred</td>
<td>x</td>
<td>x</td>
<td>-</td>
</tr>
<tr>
<td>change cred</td>
<td>x</td>
<td>x</td>
<td>-</td>
</tr>
<tr>
<td>delete cred</td>
<td>x</td>
<td>x</td>
<td>-</td>
</tr>
<tr>
<td>add eventinfo</td>
<td>x</td>
<td>x</td>
<td>-</td>
</tr>
<tr>
<td>view eventinfo</td>
<td>x</td>
<td>x</td>
<td>x</td>
</tr>
<tr>
<td>change eventinfo</td>
<td>x</td>
<td>x</td>
<td>-</td>
</tr>
<tr>
<td>delete eventinfo</td>
<td>x</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>add oplog</td>
<td>x</td>
<td>x</td>
<td>-</td>
</tr>
<tr>
<td>view oplog</td>
<td>x</td>
<td>x</td>
<td>-</td>
</tr>
<tr>
<td>change oplog</td>
<td>x</td>
<td>x</td>
<td>-</td>
</tr>
<tr>
<td>delete oplog</td>
<td>x</td>
<td>x</td>
<td>-</td>
</tr>
<tr>
<td>add payload</td>
<td>x</td>
<td>x</td>
<td>-</td>
</tr>
<tr>
<td>view payload</td>
<td>x</td>
<td>x</td>
<td>-</td>
</tr>
<tr>
<td>change payload</td>
<td>x</td>
<td>x</td>
<td>-</td>
</tr>
<tr>
<td>delete payload</td>
<td>x</td>
<td>x</td>
<td>-</td>
</tr>
<tr>
<td>add target</td>
<td>x</td>
<td>x</td>
<td>-</td>
</tr>
<tr>
<td>view target</td>
<td>x</td>
<td>x</td>
<td>-</td>
</tr>
<tr>
<td>change target</td>
<td>x</td>
<td>x</td>
<td>-</td>
</tr>
<tr>
<td>delete target</td>
<td>x</td>
<td>x</td>
<td>-</td>
</tr>
<tr>
<td>add decon</td>
<td>x</td>
<td>x</td>
<td>-</td>
</tr>
<tr>
<td>view decon</td>
<td>x</td>
<td>x</td>
<td>x</td>
</tr>
<tr>
<td>change decon</td>
<td>x</td>
<td>x</td>
<td>-</td>
</tr>
<tr>
<td>delete decon</td>
<td>x</td>
<td>x</td>
<td>-</td>
</tr>
</tbody>
</table>
<h4 id="accounts">Accounts<a class="headerlink" href="#accounts" title="Permanent link">&para;</a></h4>
<p>It is recommended to create new accounts and remove the examples once functionality of new are confirmed.</p>
<table>
<thead>
<tr>
<th>Username</th>
<th>Password</th>
<th>Role</th>
</tr>
</thead>
<tbody>
<tr>
<td>edcadmin</td>
<td>admin pass1</td>
<td>Superuser (Admin Dash)</td>
</tr>
<tr>
<td>testerld</td>
<td>user passld</td>
<td>Lead Role</td>
</tr>
<tr>
<td>testerop</td>
<td>user passwc</td>
<td>Operator</td>
</tr>
<tr>
<td>tester1</td>
<td>user pass1</td>
<td>Operator</td>
</tr>
<tr>
<td>tester2</td>
<td>user pass2</td>
<td>Operator</td>
</tr>
<tr>
<td>testerwc</td>
<td>user passwc</td>
<td>WhiteCell</td>
</tr>
</tbody>
</table>
<h5 id="account-permissions">Account Permissions<a class="headerlink" href="#account-permissions" title="Permanent link">&para;</a></h5>
<table>
<thead>
<tr>
<th>User</th>
<th>Role</th>
<th>Info</th>
<th>Oplog</th>
<th>Targets</th>
<th>Creds</th>
<th>Payload</th>
<th>Deconfliction</th>
</tr>
</thead>
<tbody>
<tr>
<td>edcadmin</td>
<td>Super</td>
<td>RWD</td>
<td>RWD</td>
<td>RWD</td>
<td>RWD</td>
<td>RWD</td>
<td>RWD</td>
</tr>
<tr>
<td>testerld</td>
<td>lead</td>
<td>RWD</td>
<td>RWD</td>
<td>RWD</td>
<td>RWD</td>
<td>RWD</td>
<td>RWD</td>
</tr>
<tr>
<td>testerop</td>
<td>operator</td>
<td>RW</td>
<td>RWD</td>
<td>RWD</td>
<td>RWD</td>
<td>RWD</td>
<td>RW</td>
</tr>
<tr>
<td>tester1</td>
<td>operator</td>
<td>RW</td>
<td>RWD</td>
<td>RWD</td>
<td>RWD</td>
<td>RWD</td>
<td>RW</td>
</tr>
<tr>
<td>tester2</td>
<td>operator</td>
<td>RW</td>
<td>RWD</td>
<td>RWD</td>
<td>RWD</td>
<td>RWD</td>
<td>RW</td>
</tr>
<tr>
<td>testerwc</td>
<td>whitecell</td>
<td>R</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>R</td>
</tr>
</tbody>
</table>
<h4 id="2fa">2FA<a class="headerlink" href="#2fa" title="Permanent link">&para;</a></h4>
<p>All accounts have the option for 2FA (Authenticator App).
Each account will need to enable 2FA via profile.</p>
<p><img alt="" src="/img/edc_2fa.png" /></p>
<p><img alt="" src="/img/edc_2fa_2.png" /></p>
<hr />
<h3 id="consolidated-security-information">Consolidated Security Information<a class="headerlink" href="#consolidated-security-information" title="Permanent link">&para;</a></h3>
<ul>
<li>Permission Based Roles (Groups)<ul>
<li>Login Required (Decorators or Mixins)</li>
<li>Permission Required (Decorator or Mixins)</li>
</ul>
</li>
<li>Role Based Accounts<ul>
<li>Lead</li>
<li>Operator</li>
<li>White Cell</li>
</ul>
</li>
<li>Individual Accounts (no group or shared accounts)</li>
<li>Multi-Factor Authentication<ul>
<li>2FA Token</li>
</ul>
</li>
<li>Protections<ul>
<li>SSL/TLS (Communication Transport)</li>
<li>Click Jacking Protection</li>
<li>Cross Site Request Forgery Protection</li>
<li>Cross Site Scripting Protection</li>
<li>Host Header Validation</li>
<li>Sessions Security</li>
<li>SQL Injection Protection</li>
<li>User uploaded content<ul>
<li>Profile limited to images<ul>
<li>All users can change respective profiles</li>
</ul>
</li>
<li>All other forms allow any file type<ul>
<li>Allows collection of various file types and interesting information</li>
<li>Enables bypass of some XSS and CSRF protections (stored - file)</li>
<li>Limited to only Leads and Operators (should be Trusted Users)</li>
</ul>
</li>
</ul>
</li>
<li>Drive or volume encryption recommended (DAR)</li>
</ul>
</li>
</ul>
<hr />
<h3 id="quick-tips">Quick Tips<a class="headerlink" href="#quick-tips" title="Permanent link">&para;</a></h3>
<ul>
<li>Tags can be any desired keyword useful to your team. These can be used to create a quick view for your desired case (i.e. identify all tagged findings)</li>
</ul>
<p><img alt="" src="/img/edc_tags.png" /></p>
<ul>
<li>User tokens must be passed for access to the rest framework.</li>
<li>All views have an associated template (vs. a tables build). Adding or removing fields from view is a simple as adding/removing from the template.</li>
<li>Some secrets are hidden from view (i.e. the plaintext password is hidden on the creds table but visible in details)</li>
<li>Setup instructions on github provides AWS S3 and Email Password Reset options</li>
<li>Anyone can register (assuming it is actually open and avail on www)<ul>
<li>There are no permissions assigned by default. Login produces no views and no access</li>
<li>The deployment should have restricted access (ACL), or be accessible only from VPN, etc.</li>
<li>You may optionally restrict registrations to a specific email domain</li>
</ul>
</li>
<li>The bashrc is recommended for use as it saves terminal logs locally. It also has several simple example functions for submitting data to EDC. These should be binaries or python execs in your path. The included functions accepts (or if omitted prompts for) entry data, appropriately names and captures a screenshot (if oplog), and submits the entry.</li>
</ul>
<hr />
<h2 id="use">Use<a class="headerlink" href="#use" title="Permanent link">&para;</a></h2>
<ul>
<li>Manual entry<ul>
<li>Use the provided forms</li>
</ul>
</li>
<li>
<p>bash_functions (see github repo)
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>    log -h
    cred -h
    target -h
</pre></div>
</td></tr></table>
<img alt="" src="/img/edc_log.png" /></p>
</li>
<li>
<p>API (curl examples)
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span># Obtain token
curl -d &#39;username=testerld&amp;password=user passld&#39; https://domain.com/api-token/

# Pull all oplogs (or /cred/ or /target/)
curl https://domain.com/oplog/ -H &#39;Authorization: Token 333...de8&#39;

# Post a new log entry
curl -d &#39;src_host=attackimage2&amp;src_ip=44.33.22.11&amp;dst_host=corpwks01&amp;dst_ip=143.144.145.146&amp;dst_port=445&amp;tool=terminal&amp;description=smb_relay&amp;result=success&amp;operator_id=9&#39; https://domain.com/oplog/ -H &#39;Authorization: Token 333...de8&#39;
</pre></div>
</td></tr></table></p>
</li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../.." title="Home" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Home
              </span>
            </div>
          </a>
        
        
          <a href="../c2-agent-comparison/" title="C2 Agent Comparison" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                C2 Agent Comparison
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Â© 2019 Threatexpress
          </div>
        
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/threatexpress" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/joevest" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.d9aa80ab.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
        <script src="https://platform.twitter.com/widgets.js"></script>
      
        <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
      
        <script src="../../../js/extra.js"></script>
      
    
  </body>
</html>