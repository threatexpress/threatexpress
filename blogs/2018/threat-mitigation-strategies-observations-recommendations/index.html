
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Threatexpress Blog">
      
      
      
      
        <link rel="prev" href="../automating-cobalt-strike-profiles-apache-mod_rewrite-htaccess-files-intelligent-c2-redirection/">
      
      
        <link rel="next" href="../hostenum-updates-usage/">
      
      
      <link rel="icon" href="../../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>Threat Mitagation Strategies - Part 1 - Threatexpress</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="red">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#threat-mitigation-strategies-observations-and-recommendations" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Threatexpress" class="md-header__button md-logo" aria-label="Threatexpress" data-md-component="logo">
      
  <img src="../../../img/threatexpress_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Threatexpress
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Threat Mitagation Strategies - Part 1
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/threatexpress" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    threatexpress/threatexpress
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Threatexpress" class="md-nav__button md-logo" aria-label="Threatexpress" data-md-component="logo">
      
  <img src="../../../img/threatexpress_logo.png" alt="logo">

    </a>
    Threatexpress
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/threatexpress" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    threatexpress/threatexpress
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://redteam.guide" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    REDTEAM.GUIDE
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Posts
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Posts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    2020
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            2020
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2020/threatbox-standard-attack-platform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ThreatBox - Standard Attack Platform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2020/red-team-development-and-operations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Red Team Development and Operations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    2019
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            2019
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2019/event-data-collector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Event Data Collector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2019/c2-agent-comparison/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    C2 Agent Comparison
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2019/git-clone-entire-org/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git clone all organizational repos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2019/penetration-testing-pasties/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Penetration Testing Pasties
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    2018
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            2018
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../a-deep-dive-into-cobalt-strike-malleable-c2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    A Deep Dive into Cobalt Strike Malleable C2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../threat-gets-a-vote-applying-a-threat-based-approach-to-security-testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Threat Get's a Vote - Applying a Threat-Based Approach to Security Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../threat-mitigation-strategies-technical-recommendations-and-info-part-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Threat Mitagation Strategies - Part 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../automating-cobalt-strike-profiles-apache-mod_rewrite-htaccess-files-intelligent-c2-redirection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Automating Cobalt Strike Profiles Apache mod_rewrite htaccess Files for Intelligent C2 Redirection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Threat Mitagation Strategies - Part 1
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Threat Mitagation Strategies - Part 1
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#topic" class="md-nav__link">
    <span class="md-ellipsis">
      Topic
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    <span class="md-ellipsis">
      Background
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#threat-synopsis" class="md-nav__link">
    <span class="md-ellipsis">
      Threat Synopsis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#problem-sets" class="md-nav__link">
    <span class="md-ellipsis">
      Problem Sets
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Problem Sets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#compliance-does-not-equate-to-security" class="md-nav__link">
    <span class="md-ellipsis">
      Compliance does not equate to security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#partial-implementation-of-security-controls-enable-a-threat" class="md-nav__link">
    <span class="md-ellipsis">
      Partial implementation of security controls enable a threat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tools-are-only-enablers" class="md-nav__link">
    <span class="md-ellipsis">
      Tools are only Enablers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#policies-and-procedural-nightmares" class="md-nav__link">
    <span class="md-ellipsis">
      Policies and Procedural Nightmares
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#client-to-client-communication" class="md-nav__link">
    <span class="md-ellipsis">
      Client-to-client communication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Client-to-client communication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#observations" class="md-nav__link">
    <span class="md-ellipsis">
      Observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-prevent-client-to-client-communication" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation: Prevent client-to-client communication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#server-to-client-communication" class="md-nav__link">
    <span class="md-ellipsis">
      Server-to-client communication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Server-to-client communication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#observations_1" class="md-nav__link">
    <span class="md-ellipsis">
      Observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-prevent-server-to-client-communication" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation: Prevent server-to-client communication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outbound-server-communications" class="md-nav__link">
    <span class="md-ellipsis">
      Outbound Server Communications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Outbound Server Communications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#observations_2" class="md-nav__link">
    <span class="md-ellipsis">
      Observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-block-outbound-server-communications" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation: Block outbound server communications
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cached-administrative-credentials" class="md-nav__link">
    <span class="md-ellipsis">
      Cached administrative credentials
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cached administrative credentials">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#observations_3" class="md-nav__link">
    <span class="md-ellipsis">
      Observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-clear-cached-administrative-credentials" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation: Clear cached administrative credentials
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#krbtgt-domain-kerberos-account" class="md-nav__link">
    <span class="md-ellipsis">
      KRBTGT (Domain Kerberos Account)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="KRBTGT (Domain Kerberos Account)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#observations_4" class="md-nav__link">
    <span class="md-ellipsis">
      Observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-reset-the-krbtgt-account" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation: Reset the KRBTGT Account
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sensitive-items" class="md-nav__link">
    <span class="md-ellipsis">
      Sensitive Items
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sensitive Items">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#observations_5" class="md-nav__link">
    <span class="md-ellipsis">
      Observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-perform-a-sensitive-items-review" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation: Perform a sensitive items review
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ports-protocols-and-services" class="md-nav__link">
    <span class="md-ellipsis">
      Ports, Protocols, and Services
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ports, Protocols, and Services">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#observations_6" class="md-nav__link">
    <span class="md-ellipsis">
      Observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-block-and-disable-non-required-ports-protocols-and-services-pps" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation: Block and Disable non-required ports, protocols, and services (PPS)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#accounts-and-privileges" class="md-nav__link">
    <span class="md-ellipsis">
      Accounts and privileges
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Accounts and privileges">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#observations_7" class="md-nav__link">
    <span class="md-ellipsis">
      Observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-1-implement-separation-of-accounts-and-privileges" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation 1: Implement separation of accounts and privileges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-2-ensure-group-permissions-are-appropriately-identified-and-mapped" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation 2: Ensure group permissions are appropriately identified and mapped.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-3-implement-microsoft-local-administrator-password-solution-laps" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation 3: Implement Microsoft Local Administrator Password Solution (LAPS)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-4-rudimentary-nix-two-factor-authentication-2fa" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation 4: Rudimentary *nix Two Factor Authentication (2FA)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#account-and-event-activity" class="md-nav__link">
    <span class="md-ellipsis">
      Account and Event Activity
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Account and Event Activity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#observations_8" class="md-nav__link">
    <span class="md-ellipsis">
      Observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-1-monitor-login-failures-and-successes" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation 1: Monitor login failures and successes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-2-consider-implementing-a-second-instance-or-dashboard-or-properly-tuning-the-primary" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation 2: Consider implementing a second instance or dashboard (or properly tuning the primary)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application-whitelisting" class="md-nav__link">
    <span class="md-ellipsis">
      Application Whitelisting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#observations_9" class="md-nav__link">
    <span class="md-ellipsis">
      Observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-application-whitelisting" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation: Application Whitelisting
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hostenum-updates-usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HostEnum - Updates and Usage Guide
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    2017
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            2017
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2017/metatwin-borrowing-microsoft-metadata-and-digital-signatures-to-hide-binaries/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Borrowing Microsoft MetaData and Signatures to Hide Binary Payloads
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2017/install-bloodhound-ubuntu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Install BloodHound on Ubuntu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2017/empire-modifying-server-c2-indicators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Empire Modifying Server C2 Indicators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2017/invoke-hostenum/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Invoke-Hostenum
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2017/leveraging-expired-domains-for-red-team-engagements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Leveraging Expired Domains for Red Team Engagements
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    2016
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            2016
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2016/slack-notifications-for-cobalt-strike/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Slack Notifications for Cobalt Strike
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2016/web-shells-covert-channel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SubShell and TinyShell - Custom Covert Webshells
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2016/new-information-security-red-teaming-blog-threat-express-minis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    New Information Security and Red Teaming Blog Threat Express by MINIS
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Red Teaming
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Red Teaming
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redteaming/redteaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    What is Red Teaming
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redteaming/red_vs_pen_vs_vuln/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Red vs Pen vs Vuln
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redteaming/rolesandrelationships/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Roles and Relationships
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redteaming/mitre_attack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Red Teaming and MITRE ATT&CK
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redteaming/definitions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Definitions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Red Team Planning
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            Red Team Planning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redteaming/redteamplanning/goalplanning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Goal Planing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redteaming/redteamplanning/redteamchecklist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Red Team Checklist
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redteaming/redteamplanning/roeguide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Red Team ROE Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redteaming/redteamplanning/tradecraft/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tradecraft Guidance
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7" >
        
          
          <label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Red Team IOCs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            Red Team IOCs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redteaming/tool_ioc/tinyshell_ioc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TinyShell IOCs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redteaming/tool_ioc/psexec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PSEXEC IOCs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://jpcertcc.github.io/ToolAnalysisResultSheet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    JPCert IOCs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://digital-forensics.sans.org/media/SANS_Poster_2018_Hunt_Evil_FINAL.pdf" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SANS Hunt Evil
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_8" >
        
          
          <label class="md-nav__link" for="__nav_4_8" id="__nav_4_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Red Team Resources
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_8">
            <span class="md-nav__icon md-icon"></span>
            Red Team Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redteaming/cheatsheets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cheatsheets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redteaming/resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    General Resources
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redteaming/windowsactivedirectory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Attack Active Directory
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../redteaming/videos/videos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Red Team Videos
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../archive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Post Archive
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributors
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#topic" class="md-nav__link">
    <span class="md-ellipsis">
      Topic
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    <span class="md-ellipsis">
      Background
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#threat-synopsis" class="md-nav__link">
    <span class="md-ellipsis">
      Threat Synopsis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#problem-sets" class="md-nav__link">
    <span class="md-ellipsis">
      Problem Sets
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Problem Sets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#compliance-does-not-equate-to-security" class="md-nav__link">
    <span class="md-ellipsis">
      Compliance does not equate to security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#partial-implementation-of-security-controls-enable-a-threat" class="md-nav__link">
    <span class="md-ellipsis">
      Partial implementation of security controls enable a threat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tools-are-only-enablers" class="md-nav__link">
    <span class="md-ellipsis">
      Tools are only Enablers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#policies-and-procedural-nightmares" class="md-nav__link">
    <span class="md-ellipsis">
      Policies and Procedural Nightmares
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#client-to-client-communication" class="md-nav__link">
    <span class="md-ellipsis">
      Client-to-client communication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Client-to-client communication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#observations" class="md-nav__link">
    <span class="md-ellipsis">
      Observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-prevent-client-to-client-communication" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation: Prevent client-to-client communication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#server-to-client-communication" class="md-nav__link">
    <span class="md-ellipsis">
      Server-to-client communication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Server-to-client communication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#observations_1" class="md-nav__link">
    <span class="md-ellipsis">
      Observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-prevent-server-to-client-communication" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation: Prevent server-to-client communication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outbound-server-communications" class="md-nav__link">
    <span class="md-ellipsis">
      Outbound Server Communications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Outbound Server Communications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#observations_2" class="md-nav__link">
    <span class="md-ellipsis">
      Observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-block-outbound-server-communications" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation: Block outbound server communications
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cached-administrative-credentials" class="md-nav__link">
    <span class="md-ellipsis">
      Cached administrative credentials
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cached administrative credentials">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#observations_3" class="md-nav__link">
    <span class="md-ellipsis">
      Observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-clear-cached-administrative-credentials" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation: Clear cached administrative credentials
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#krbtgt-domain-kerberos-account" class="md-nav__link">
    <span class="md-ellipsis">
      KRBTGT (Domain Kerberos Account)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="KRBTGT (Domain Kerberos Account)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#observations_4" class="md-nav__link">
    <span class="md-ellipsis">
      Observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-reset-the-krbtgt-account" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation: Reset the KRBTGT Account
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sensitive-items" class="md-nav__link">
    <span class="md-ellipsis">
      Sensitive Items
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sensitive Items">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#observations_5" class="md-nav__link">
    <span class="md-ellipsis">
      Observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-perform-a-sensitive-items-review" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation: Perform a sensitive items review
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ports-protocols-and-services" class="md-nav__link">
    <span class="md-ellipsis">
      Ports, Protocols, and Services
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ports, Protocols, and Services">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#observations_6" class="md-nav__link">
    <span class="md-ellipsis">
      Observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-block-and-disable-non-required-ports-protocols-and-services-pps" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation: Block and Disable non-required ports, protocols, and services (PPS)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#accounts-and-privileges" class="md-nav__link">
    <span class="md-ellipsis">
      Accounts and privileges
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Accounts and privileges">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#observations_7" class="md-nav__link">
    <span class="md-ellipsis">
      Observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-1-implement-separation-of-accounts-and-privileges" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation 1: Implement separation of accounts and privileges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-2-ensure-group-permissions-are-appropriately-identified-and-mapped" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation 2: Ensure group permissions are appropriately identified and mapped.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-3-implement-microsoft-local-administrator-password-solution-laps" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation 3: Implement Microsoft Local Administrator Password Solution (LAPS)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-4-rudimentary-nix-two-factor-authentication-2fa" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation 4: Rudimentary *nix Two Factor Authentication (2FA)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#account-and-event-activity" class="md-nav__link">
    <span class="md-ellipsis">
      Account and Event Activity
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Account and Event Activity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#observations_8" class="md-nav__link">
    <span class="md-ellipsis">
      Observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-1-monitor-login-failures-and-successes" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation 1: Monitor login failures and successes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-2-consider-implementing-a-second-instance-or-dashboard-or-properly-tuning-the-primary" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation 2: Consider implementing a second instance or dashboard (or properly tuning the primary)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application-whitelisting" class="md-nav__link">
    <span class="md-ellipsis">
      Application Whitelisting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#observations_9" class="md-nav__link">
    <span class="md-ellipsis">
      Observations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendation-application-whitelisting" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendation: Application Whitelisting
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="threat-mitigation-strategies-observations-and-recommendations">Threat Mitigation Strategies: Observations and Recommendations<a class="headerlink" href="#threat-mitigation-strategies-observations-and-recommendations" title="Permanent link">&para;</a></h1>
<p><strong>James Tubberville | January 25, 2018 | Tweet This Post: <a href="https://twitter.com/intent/tweet?url=http://threatexpress.com/blogs/2018/threat-mitigation-strategies-observations-recommendations/&amp;text=Threat Mitigation Strategies - Part 1"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg></span></a></strong></p>
<p><em>Full disclosure: This post is heavy on text. Much of the content is very broad and uses simplified examples. There are literally thousands of extremely cool and interesting ways to limit threat activity; however, I've decided to simplify and focus on those that could have the most significant impact with relatively easy implementation. Enjoy!</em></p>
<p><img alt="" src="/img/20180125_132744_attack.png" /></p>
<h2 id="topic">Topic<a class="headerlink" href="#topic" title="Permanent link">&para;</a></h2>
<p>While much of the world talks of protecting against an Advanced Persistent Threat (APT), in reality nearly all organizations and networks have an extremely hard time protecting against basic (or dare I say novice?) threats. I've been wanting to write a full white paper on the topic, but can't seem to find the time. Rather, I've decided to summarize my experience into a short series. The first in this series provides an introduction divided into three categories: general problem sets, observations, and recommendations. Follow-on post in the series will provide the technical detail (or "how to") for each of the recommendations.</p>
<h2 id="background">Background<a class="headerlink" href="#background" title="Permanent link">&para;</a></h2>
<p>Over the years my team has performed numerous evaluations against a variety of networks. These evaluations attempted to extend beyond the simple enumeration of potential vulnerabilities (i.e. patches, updates and compliance measures) by reviewing the actions of real-world cyber based threats and attacks. Each assisted in determining the true risk associated with actions performed by a knowledgeable and determined threat. Each evaluation focused on these realistic risk profiles rather than focusing on ephemeral vulnerabilities.</p>
<h2 id="threat-synopsis">Threat Synopsis<a class="headerlink" href="#threat-synopsis" title="Permanent link">&para;</a></h2>
<p>For those unfamiliar with threat operations, I think it is important to annotate the simplified set of threat actions commonly performed in a network prior to identification of problem sets, observations and recommendations.</p>
<blockquote>
<p>So, what does an example attack path look like?</p>
</blockquote>
<p>A threat typically gains access to an externally facing system or service (commonly in a DMZ) that is, in most instances, managed by the internal domain (not a true DMZ). The second method of access involves targeting internal client workstations by phishing, web drive-by, or some other form of social engineering.</p>
<p>Once a threat has gained initial access, they leverage various lateral movement techniques to traverse the network away from the initial foothold. At this stage, a threat commonly establishes a method for command and control (C2) and persistence. C2 is simply the influence a threat has over a system to which access has been achieved. Persistence is simply a method for re-establishing or regaining access to C2. The established C2 and continued lateral movement enables the discovery of additional systems, interesting files, and potential paths to a target. The target is the information, system, person or process for which the threat is attempting to access. The threat re-evaluates each pivot through the network looking for these items and for methods of privilege escalation.</p>
<p>In real-world scenarios, this stage is when the threat finds elevated account credentials stored in a file or pulls tokens and credentials from memory; however, there are also numerous methods for leveraging applications and services to gain elevated access. Threats repeat this process until privileges have been escalated to that of a Domain Administrator (DA) or higher.</p>
<p>Once escalation is achieved, the threat most often targets a server, commonly the Domain Controller (DC). The DC communicates with and controls virtually everything within a windows based network. At this stage, the threat often has access to the target and can perform information collection and impacts as desired. In short, it's usually game over for the target.</p>
<p>Although this simplification identifies a Windows based network. It is also important to understand that access to a server, DC, or directory services may not be a requirement for access or impact to the target; however, it is more often than not a major enabler.</p>
<p>This synopsis simply demonstrates that most threat attack paths follow the same principles of <strong>getting in</strong>, <strong>staying in</strong> and <strong>acting</strong> regardless of the tools, techniques, and procedures (TTPs), or motivators.</p>
<h2 id="problem-sets">Problem Sets<a class="headerlink" href="#problem-sets" title="Permanent link">&para;</a></h2>
<p>As IT and security professionals, we must understand that "security" isn't what we should strive towards. Our purpose is to enable the objectives, functions, sustainment and success of the businesses and systems we support. Rather than forcing the concepts of "security", we should be identifying and communicating how our efforts support those basic business requirements and provide solutions to existing (and potential) problems to business success. In this article, I'm focusing on those security problems in which most IT and security staff directly influence. Although every organization has it's own unique set of problems, there is a clear commonality that all lead to four root causes.</p>
<div class="admonition tip">
<p class="admonition-title">Consider This</p>
</div>
<p>Anyone has the ability to influence any aspect of the organization regardless of their position!</p>
<h3 id="compliance-does-not-equate-to-security">Compliance does not equate to security<a class="headerlink" href="#compliance-does-not-equate-to-security" title="Permanent link">&para;</a></h3>
<p>Given the general construct of how a threat's actions might leverage a network's architecture, simply meeting compliance requirements does little to enable the prevention or detection of threat actions. Across the board, compliance has been set as the bar of achievement when, in reality, compliance is the absolute minimum set of controls, policies and procedures that should be enforced. Don't misunderstand the concept. Compliance is absolutely a requirement and does much for the general security posture of a system or network. However, I've tested hundreds of systems and networks that (at least on paper) were fully compliant with their required standard, but failed to adequately protect the business and associated functions/information.</p>
<h3 id="partial-implementation-of-security-controls-enable-a-threat">Partial implementation of security controls enable a threat<a class="headerlink" href="#partial-implementation-of-security-controls-enable-a-threat" title="Permanent link">&para;</a></h3>
<p>Of the compliance measures employed, many are only partially implemented. One example observed in every effort to date are remote management capabilities. Most Windows Firewall requirements state unsolicited inbound connections must be blocked; however, in each evaluation all hosts tested were able to send and receive connections to/from other devices on the network. Although a firewall was installed and active, it allowed connections via multiple ports, protocols and services (PPS). While this is a single example, it emphasizes the methods in which compliance measures are only partially implemented.</p>
<h3 id="tools-are-only-enablers">Tools are only Enablers<a class="headerlink" href="#tools-are-only-enablers" title="Permanent link">&para;</a></h3>
<p>Another commonality across the board is an over reliance on tools to perform prevention and detection activities. Our industry dedicates large amounts of valuable resources to the development or purchase of systems and software (tools) that provide little value in the overall security of a network. Many of these tools have been in use or development for multiple years and have undergone numerous reviews; however, few have been successful in thwarting real-world threats. In fact, many of the tools deployed to date have been easily bypassed, detected or leveraged by knowledgeable threats. Tools are enablers. They provide a cognizant human with the information required to make an intelligent decision.</p>
<h3 id="policies-and-procedural-nightmares">Policies and Procedural Nightmares<a class="headerlink" href="#policies-and-procedural-nightmares" title="Permanent link">&para;</a></h3>
<p>Cumbersome policies and procedures elongate the process for implementing timely and effective defensive mitigations. All interviewed system, network and defensive staff identified longstanding issues with receiving approval to implement change <strong>and</strong> the timeliness of any approvals received. This concern has been relayed throughout the industry for years. If policy and procedures are primary inhibitors to the successful defense of our networks, policy and procedures must be modified to accommodate the need.</p>
<p>If detailed, the number of existing problem sets, vulnerabilities, and operational requirements far exceed any realistic ability to read, digest and act in a timely manner. The four problem sets listed above are of high importance as they are the foundation to all other sets. Each organization must begin addressing methods for limiting a threat's actions without increasing complexity, impacting the way in which systems and networks operate by design (user work-flow), or chasing ephemeral vulnerabilities. I'm left asking myself, why would we (the IT and security community) continue down the same ineffective paths, but continuously expect different results?</p>
<p>While meeting compliance requirements does have an extremely valuable effect on security, the next section provides recommendations that would benefit any organization far more.</p>
<p>Each of the observations and recommendations are the result of many, many efforts. The recommendations can be applied to any and all networks. Some networks will have exceptions; however, these are exceptions (not the status quo) and should be handled as such.</p>
<h2 id="client-to-client-communication">Client-to-client communication<a class="headerlink" href="#client-to-client-communication" title="Permanent link">&para;</a></h2>
<p>Clients rarely need to communicate amongst themselves. Over a roughly eighteen-year period and hundreds of various networks, less than a handful of architectures have had requirements for client-to-client communication (most due to application design failures/features).</p>
<h3 id="observations">Observations<a class="headerlink" href="#observations" title="Permanent link">&para;</a></h3>
<p>Of the systems and networks evaluated in recent years, none have required client-to-client communications. In fact, most have already implemented some type of host-based firewall. Yet in every network evaluated to date, all have been configured to allow client-to-client communication. Often the systems, network and defensive teams were unaware that such communications were allowed. In other instances administrative functions were identified as reasons for allowing communication.</p>
<p><strong>Example:</strong> During review, each network staff identifies that host-based firewalls have been implemented; however, initiating a connection to other clients using multiple ports and protocols has always been successful. Most often the staff cite requirements for system and network administration using Server Message Block (SMB), Remote Desktop Protocol (RDP) or another Remote Administration Tool (RAT). In several instances, security tools were also identified as reasoning for allowing client-to-client communications.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
</div>
<p>There are multiple methods of allowing communications for administrative purposes only when required and should never be allowed perpetually.</p>
<h3 id="recommendation-prevent-client-to-client-communication">Recommendation: Prevent client-to-client communication<a class="headerlink" href="#recommendation-prevent-client-to-client-communication" title="Permanent link">&para;</a></h3>
<p>Simply implement and configure host and network based firewalls, IPTables, Access Control Lists (ACLs), etc. Leverage any and all capabilities of the network and organization. Preventing these communications limits a threat's ability to move freely throughout the network, reduces the likelihood of privileged account discovery, forces an increase in time and effort (more activities and artifacts), and therefore can increase the defender's ability to detect.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
</div>
<p>Effective configuration of host based firewalls requires a thorough understanding of what network traffic should occur (what does normal look like?).</p>
<hr />
<h2 id="server-to-client-communication">Server-to-client communication<a class="headerlink" href="#server-to-client-communication" title="Permanent link">&para;</a></h2>
<p>Most client-server designs require a client to request information from a server. Experience has provided few instances where a server should initiate communications to a client.</p>
<h3 id="observations_1">Observations<a class="headerlink" href="#observations_1" title="Permanent link">&para;</a></h3>
<p>Of the networks evaluated, none have required server-to-client communications. Yet in every network evaluated to date, all have been configured to allow server-to-client communication. A common threat action is to leverage a server's ability to communicate with clients or segments to move through a network. This often allows the threat to access targets or bridge network segments even when segmentation has been properly implemented.</p>
<h3 id="recommendation-prevent-server-to-client-communication">Recommendation: Prevent server-to-client communication<a class="headerlink" href="#recommendation-prevent-server-to-client-communication" title="Permanent link">&para;</a></h3>
<p>Assuming the network has prevented client-to-client communications, the only option a threat has is to attempt access to a server. Given this scenario, it is more than feasible to limit a server's ability to initiate communications with a client. This recommendation limits the threat's ability to move from workstation, to a server and back to another workstation. When connections to clients are attempted, those should stand out as indicators of malicious activity.</p>
<p>The most common IT staff concern with this implementation is malfunctioning or broken clients. This is a perfect example of where security implementations assist with the overall health of the network. If a client cannot initiate communications with the server, the client has other issues. This should be cause for investigation and correction rather than simply forcing connections from the server.</p>
<p>Another common concern is the ability to "push" software, updates, etc. from the server. This is another instance where best practices are not being followed. A client should always request from a server. If deploying software or updates, the client should be notified when communicating with the server (via policy, configurations, etc.) and pull the respective requirements.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
</div>
<p>In this context, a server is a functional role rather than a type of device.</p>
<hr />
<h2 id="outbound-server-communications">Outbound Server Communications<a class="headerlink" href="#outbound-server-communications" title="Permanent link">&para;</a></h2>
<p>With very few exceptions, servers should never call outside the network.</p>
<h3 id="observations_2">Observations<a class="headerlink" href="#observations_2" title="Permanent link">&para;</a></h3>
<p>Of the networks evaluated, all have had servers that allow communication with external (non-organizational) systems. This communication allows a threat to exfiltrate data directly from a server in which it has gained access. It also allows data restricted to certain network segments to be moved through a server and out of the network, often without detection.</p>
<h3 id="recommendation-block-outbound-server-communications">Recommendation: Block outbound server communications<a class="headerlink" href="#recommendation-block-outbound-server-communications" title="Permanent link">&para;</a></h3>
<p>There are few instances where a server needs to communicate with a system external to the network. These are exceptions and should be managed to allow only connections to the required external asset or IP and allow only the use of required ports and protocols. All other outbound communications from servers should be blocked. This implementation combined with the limits between clients and server-to-client exponentially increases the difficulty of lateral movement and command and control.</p>
<details class="question">
<summary>Should your internal Domain Controller manage the server in the DMZ?</summary>
</details>
<p>Of course not, but how many organization effectively control communication paths?</p>
<hr />
<h2 id="cached-administrative-credentials">Cached administrative credentials<a class="headerlink" href="#cached-administrative-credentials" title="Permanent link">&para;</a></h2>
<p>Cached credential discovery is a common and primary method in which threats escalate privileges. Cached credentials are simply credentials temporarily stored for use by the system in which they reside. When administrative access for the current activity or session ends, the cached credential is no longer required.</p>
<h3 id="observations_3">Observations<a class="headerlink" href="#observations_3" title="Permanent link">&para;</a></h3>
<p>Of the networks evaluated, all have had cached administrative credentials present. These credentials are stored in memory when system and network administrators perform maintenance functions, when helpdesk personnel perform user support and when a tool is used to perform an automated task. This is a common problem on virtually all networks and the reason why a threat will leverage this functionality.</p>
<h3 id="recommendation-clear-cached-administrative-credentials">Recommendation: Clear cached administrative credentials<a class="headerlink" href="#recommendation-clear-cached-administrative-credentials" title="Permanent link">&para;</a></h3>
<p>Clearing credentials is relatively easy to do, yet is not often done. A few simple registry changes and requiring administrators to reboot (mainly workstations/clients) after using elevated accounts is a great step forward in limiting cached credentials. Also, forcing the use of Remote Desktop Credential Guard and Restricted Admin (see client-to-client above) has proven to be helpful in limitations; however, depending upon function, there may still be cached credentials present. It is recommended to always reboot after administrative functions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
</div>
<p>There are also several methods for injecting invalid credentials into memory for use as indicators. These HoneyTokens can be used as indicators of malicious activity.</p>
<hr />
<h2 id="krbtgt-domain-kerberos-account">KRBTGT (Domain Kerberos Account)<a class="headerlink" href="#krbtgt-domain-kerberos-account" title="Permanent link">&para;</a></h2>
<p>By now most have heard of Golden Tickets (GT) and Silver Tickets (ST) created via the domain KRBTGT (Domain Kerberos) account's NTLM hash. These tickets can be valid for extremely long periods of time and allow access to domain resources even after administrative credentials have been changed.</p>
<h3 id="observations_4">Observations<a class="headerlink" href="#observations_4" title="Permanent link">&para;</a></h3>
<p>Although many security professionals understand the GT/ST concept, most standard IT staff either don't know or are unclear on how they work. Many of the organizations evaluated have never reset the KRBTGT account. Of the few that have, many only reset once. This first reset does change the credential; however, the initial reset also creates a "backup". Due to this functionality, the KRBTGT account must be reset twice to flush old credentials completely. Only after the second reset are existing Golden and Silver Tickets rendered useless.</p>
<h3 id="recommendation-reset-the-krbtgt-account">Recommendation: Reset the KRBTGT Account<a class="headerlink" href="#recommendation-reset-the-krbtgt-account" title="Permanent link">&para;</a></h3>
<p>Reset the KRBTGT account twice within a limited time-frame (36-48 hours apart is recommended) followed by the changing of all administrative credentials. These resets limit a threat's ability to maintain access after credential changes. The administrative credential change is highly recommended and should be required. If the threat has a valid GT they have obtained valid credentials. A new Golden Ticket can be created after the KRBTGT reset if credentials have not been changed (defeating the purpose of the KRBTGT reset). This process should be completed periodically (no less frequently than quarterly).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
</div>
<p>Anyone using assets not on the network during the resets (traveling, out of office, etc.) will likely need help authenticating when reconnecting.</p>
<hr />
<h2 id="sensitive-items">Sensitive Items<a class="headerlink" href="#sensitive-items" title="Permanent link">&para;</a></h2>
<p>Sensitive items include credentials, configuration files, Privacy of Information Act (PIA) data, Intellectual Property, anything close-hold or critical to business operations, etc.</p>
<h3 id="observations_5">Observations<a class="headerlink" href="#observations_5" title="Permanent link">&para;</a></h3>
<p>In every network evaluated, multiple instances of sensitive items were discovered. Items were found in many different locations to include organizational file shares, personal file shares, workstation directories, server directories, organizational websites and often on external (non-organizational) websites. More often than not, they are available to anyone with access to the network. These items provide the threat either the information for the target or the information required to obtain access to the target.</p>
<h3 id="recommendation-perform-a-sensitive-items-review">Recommendation: Perform a sensitive items review<a class="headerlink" href="#recommendation-perform-a-sensitive-items-review" title="Permanent link">&para;</a></h3>
<p>Perform frequent search and discovery activities for critical items stored across the network and network systems. With the exception of credential storage, there are legitimate reasons for storing information such as configurations, diagrams, business information, etc. on the network. These need special focus to determine where they are stored, who has access and if they have any authenticators or credentials.</p>
<p>Challenge: Perform a string search for "pass", "assw", "pwd", "key", and "Type 7" on the network. You may be amazed at what is discovered.</p>
<hr />
<h2 id="ports-protocols-and-services">Ports, Protocols, and Services<a class="headerlink" href="#ports-protocols-and-services" title="Permanent link">&para;</a></h2>
<p>Ports, protocols and services (PPS) are simply the technical means by which networks communicate.</p>
<h3 id="observations_6">Observations<a class="headerlink" href="#observations_6" title="Permanent link">&para;</a></h3>
<p>In every network evaluated, PPS were not limited to only those required. This applies to internal as much as external communications. Many organizations rely on firewalls to limit specific ports and protocols from external sources; however, they have limited controls on what PPS traverse the internal network. Even when internal firewalls are in place, traffic is often not restricted appropriately.</p>
<h3 id="recommendation-block-and-disable-non-required-ports-protocols-and-services-pps">Recommendation: Block and Disable non-required ports, protocols, and services (PPS)<a class="headerlink" href="#recommendation-block-and-disable-non-required-ports-protocols-and-services-pps" title="Permanent link">&para;</a></h3>
<p>Both internal and external systems and network devices should block PPS that aren't required for the network. Limit PPS to only what is required for each specific system. Think of this as "PPS white-listing". Does the network have a need for port 5900 to traverse the entire network? Or is there a need for port 5900 to a specific system? Does the network really need IPX/SPX, WPAD, LLMNR, and NetBIOS enabled? Controlling PPS limits a threat's range of capabilities and increases chances of detection.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
</div>
<p>Firewalls (network or host based) are listed above as an easy example. Network based firewalls are simply traffic control devices that allow ingress and egress traffic based upon configuration. Host based firewalls do the same for individual hosts.</p>
<hr />
<h2 id="accounts-and-privileges">Accounts and privileges<a class="headerlink" href="#accounts-and-privileges" title="Permanent link">&para;</a></h2>
<p>Accounts, group memberships, and privileges are primary enablers for most threat actions. Effective management and control greatly limits a threat's ability to execute within a network.</p>
<h3 id="observations_7">Observations<a class="headerlink" href="#observations_7" title="Permanent link">&para;</a></h3>
<p>Many organizations have user accounts with some level of elevated access, administrative accounts that administer multiple resource types, and groups with specific permissions nested within other groups with higher level permissions. Each of these enable a threat to freely escalate privileges to a level required to meet their objective.</p>
<div class="admonition tip">
<p class="admonition-title">Consider this Concept</p>
</div>
<p>A threat has the ability to elevate a standard user to one of privileged access, elevate a privileged access account to local administrator, and/or elevate local administrator to domain administrator. If a threat has the ability to escalate a standard user account to that of DA, so does every other user on the network.</p>
<h3 id="recommendation-1-implement-separation-of-accounts-and-privileges">Recommendation 1: Implement separation of accounts and privileges<a class="headerlink" href="#recommendation-1-implement-separation-of-accounts-and-privileges" title="Permanent link">&para;</a></h3>
<p>Ensure separation of user, privileged access, and administrator accounts. Also ensure administrative accounts can only administer within its area of responsibility. System administrators should only administer systems and not have access to servers. Server administrators should only be able to administer servers and not have access to workstations. Domain administrators should not have access to administer servers or workstations.</p>
<p>Users should be limited to only what is required to perform daily tasks. Standard users often do not require elevated privileges on a daily basis. In rare scenarios where a user needs elevation often, require the use of a secondary account with only the access required and no external communications ability. Likewise, administrators shouldn't be using elevated accounts for daily tasks. <em>As a general rule all elevated accounts should be restricted from external communications (including internet and email).</em></p>
<p>Also, consider having separate dedicated administrative systems with no email client, Internet browser, timecard access, document editing, any external communication, etc.</p>
<h3 id="recommendation-2-ensure-group-permissions-are-appropriately-identified-and-mapped">Recommendation 2: Ensure group permissions are appropriately identified and mapped.<a class="headerlink" href="#recommendation-2-ensure-group-permissions-are-appropriately-identified-and-mapped" title="Permanent link">&para;</a></h3>
<p>This recommendation has multiple applications; however, the main focus is nested groups and permissions. Nesting is a common problem in nearly every windows based-network in existence. Is it easier to troubleshoot permissions or give a user membership to a group to solve the problem? We've all been there.</p>
<div class="admonition tip">
<p class="admonition-title">Consider this Concept</p>
</div>
<p>Group 3 has domain access. Group 2 has server access. Group 1 has workstation access. Group 0 are domain users in a specific division. If a member of Group 0 is assigned to Group 1 due to an elevation requirement, the chances of that user being able to escalate to domain administrator (Group 3) are high. This occurs simply because at least one member of Group 1 is likely a member of Group 2, and at least one member of Group 2 is likely a member of Group 3. It may require a bit of work, but these are the paths and nested permissions a threat will leverage to gain elevated access.</p>
<h3 id="recommendation-3-implement-microsoft-local-administrator-password-solution-laps">Recommendation 3: Implement Microsoft Local Administrator Password Solution (LAPS)<a class="headerlink" href="#recommendation-3-implement-microsoft-local-administrator-password-solution-laps" title="Permanent link">&para;</a></h3>
<p>LAPS provides automated local administrator account management for every computer in Active Directory. A client-side component generates a random password, updates the LAPS password on the Active Directory computer account, and sets the password locally. LAPS configuration is managed through Group Policy which provides the values for password complexity, password length, local account name for password change, password change frequency, etc.</p>
<h3 id="recommendation-4-rudimentary-nix-two-factor-authentication-2fa">Recommendation 4: Rudimentary *nix Two Factor Authentication (2FA)<a class="headerlink" href="#recommendation-4-rudimentary-nix-two-factor-authentication-2fa" title="Permanent link">&para;</a></h3>
<p>Many organizations have issues with credential reuse and implementation of Two Factor Authentication (2FA) in *nix based systems especially in off-line or closed networks. A very rudimentary but simple implementation of 2FA is the use of ssh key-files. The user generates a key-file that requires a password for use. The system administrator configures the system to require a key and password. The user now must use the password protected key-file to connect and the system password to complete authentication.</p>
<hr />
<h2 id="account-and-event-activity">Account and Event Activity<a class="headerlink" href="#account-and-event-activity" title="Permanent link">&para;</a></h2>
<p>Account and event activity should be major factors in identifying potential issues or threats within a network. Unfortunately, these are often logged but rarely monitored effectively.</p>
<h3 id="observations_8">Observations<a class="headerlink" href="#observations_8" title="Permanent link">&para;</a></h3>
<p>Account and event activity collection is commonly identified as a compliance item and treated as a box to be checked. Multiple organizations have successfully configured logging and event forwarding and have alerts to match each event. Yet a common issue discovered in every organization to date is the unreasonable number of notifications or alerts received. Defensive staff are unable to follow every thread to a root cause due to time constraints and the vast number of alerts received. If a dedicated defensive team is unable to run every alert to ground, the alerts, logging, and collection has not been appropriately configured and tuned.</p>
<h3 id="recommendation-1-monitor-login-failures-and-successes">Recommendation 1: Monitor login failures and successes<a class="headerlink" href="#recommendation-1-monitor-login-failures-and-successes" title="Permanent link">&para;</a></h3>
<p>Short and simple. Multiple fails followed by a success indicates bad things. Many organizations focus on the failures and only respond when a target number of failures occur (i.e. three failed attempts per account or 300 failed attempts total).</p>
<div class="admonition tip">
<p class="admonition-title">Consider this Concept</p>
</div>
<p>A threat has a password discovered via open source intelligence. The account is unknown; however, the password file has a recent date. The threat performs one validation per account for all accounts on the network (or Outlook Web Access or external SharePoint Portal). After twenty attempts one account has the same password and successfully authenticates. This action met neither of the conditions for alerting. Would this action be identified?</p>
<h3 id="recommendation-2-consider-implementing-a-second-instance-or-dashboard-or-properly-tuning-the-primary">Recommendation 2: Consider implementing a second instance or dashboard (or properly tuning the primary)<a class="headerlink" href="#recommendation-2-consider-implementing-a-second-instance-or-dashboard-or-properly-tuning-the-primary" title="Permanent link">&para;</a></h3>
<p>Given that most organizations have a compliance requirement to log all events, it is unreasonable to discard all incoming data. It is feasible to tune the primary or a second instance, dashboard, etc. to look specifically for the indicators as described above.</p>
<p><strong>Example:</strong> The network has been configured to prevent client-to-client communications. If client-to-client communications are attempted, an alert provides notification.</p>
<p>!!! Note:
The example action should occur for the eight or ten actions common to most threats. Eight or ten possible scenarios are much easier to monitor and maintain <em>and</em> provide a realistic view of potential threats (outsider or insider) within the network.</p>
<hr />
<h3 id="application-whitelisting">Application Whitelisting<a class="headerlink" href="#application-whitelisting" title="Permanent link">&para;</a></h3>
<p>Application Whitelisting is the process of identifying approved software, allowing only those applications to run on a system, and blocking all others.</p>
<h3 id="observations_9">Observations<a class="headerlink" href="#observations_9" title="Permanent link">&para;</a></h3>
<p>Application Whitelisting is extremely useful in securing a network; however, for any organization with a larger footprint, dispersed locations and a diverse set of business requirements; it can be cumbersome to configure and maintain. In addition, many Application Whitelisting tools and techniques have been bypassed or leveraged to execute malicious code and security researchers continue to discover new ways of doing so. Application Whitelisting provides some value to the overall security of a network, but isn't the silver bullet everyone expects. Combined with other recommendations Application Whitelisting provides an exponential increase in time and difficulty to a threat.</p>
<h3 id="recommendation-application-whitelisting">Recommendation: Application Whitelisting<a class="headerlink" href="#recommendation-application-whitelisting" title="Permanent link">&para;</a></h3>
<p>Implement Application Whitelisting only after all of the prior recommendations have been implemented. An interim strategy (until Application Whitelisting can be fully implemented) may be to prevent standard user execution of specific applications such as: arp, at, certutil, cscript, cmd, dsquery, hostname, ipconfig, msbuild, nbtstat, net, netsh, netstat, nslookup, ntdsutil, pcalua, ping, powershell, psexec, reg, regasm, regedit, regedt32, regsvr32, regsvcs, rundll32, set, sc, schtasks, systeminfo, tasklist, tracert, whoami, wmic, wscript, wsmprovhost, etc.</p>
<details class="question">
<summary>Do standard users normally run any of the preceding commands? Should they?</summary>
</details>
<p>Most users do not use these commands. If they do, why?</p>
<hr />
<p>Most organizations have historically focused on prevention (which is why we consistently see networks with a harder exterior and soft chewy center). While prevention is a huge concern, complete protection will never be possible. Although preventative in nature, the major benefit of the listed recommendations is relative ease of detection. Each activity performed outside the baseline should stand out as indicators of malicious activity.</p>
<p>My closing recommendation is for all organizations and security professionals to adopt the concept of <em>"Assumed Breach"</em>. An Assumed Breach mentality accepts that a network is currently, or will eventually be, compromised. Prepare your networks and business functions as if there's a known or impending threat to the network. I'll expand more on this in future posts.</p>
<details class="question">
<summary>If a standard user was given administrative credentials while sitting at their workstation, what could they do?</summary>
</details>
<p>What did you come up with?
Should a user be able to perform those actions?</p>
<hr />
<p>Refer to <a href="http://threatexpress.com/blogs/2018/threat-mitigation-strategies-technical-recommendations-and-info-part-2/">Part 2</a> for detailed technical implementation.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../automating-cobalt-strike-profiles-apache-mod_rewrite-htaccess-files-intelligent-c2-redirection/" title="Automating Cobalt Strike Profiles Apache mod_rewrite htaccess Files for Intelligent C2 Redirection" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Automating Cobalt Strike Profiles Apache mod_rewrite htaccess Files for Intelligent C2 Redirection
              </span>
            </div>
          </a>
        
        
          <a href="../hostenum-updates-usage/" title="HostEnum - Updates and Usage Guide" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                HostEnum - Updates and Usage Guide
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
             2019 Threatexpress
          </div>
        
      </div>
      <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/threatexpress" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/joevest" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
</div>
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="https://platform.twitter.com/widgets.js"></script>
      
        <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
      
        <script src="../../../js/extra.js"></script>
      
    
  </body>
</html>