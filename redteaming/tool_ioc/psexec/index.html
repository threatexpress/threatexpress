



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Threatexpress Blog">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.3">
    
    
      
        <title>PSEXEC IOCs - Threatexpress</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.30686662.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="black" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#psexecexe-iocs-and-detection" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../.." title="Threatexpress" class="md-header-nav__button md-logo">
          
            <img src="../../../img/threatexpress_logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Threatexpress
            </span>
            <span class="md-header-nav__topic">
              
                PSEXEC IOCs
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/threatexpress/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    threatexpress/threatexpress
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../.." title="Threatexpress" class="md-nav__button md-logo">
      
        <img src="../../../img/threatexpress_logo.png" width="48" height="48">
      
    </a>
    Threatexpress
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/threatexpress/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    threatexpress/threatexpress
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Posts
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Posts
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1">
    
    <label class="md-nav__link" for="nav-2-1">
      2019
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        2019
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2019/c2-agent-comparison/" title="C2 Agent Comparison" class="md-nav__link">
      C2 Agent Comparison
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2019/git-clone-entire-org/" title="Git clone all organizational repos" class="md-nav__link">
      Git clone all organizational repos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2019/penetration-testing-pasties/" title="Penetration Testing Pasties" class="md-nav__link">
      Penetration Testing Pasties
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      2018
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        2018
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2018/a-deep-dive-into-cobalt-strike-malleable-c2/" title="A Deep Dive into Cobalt Strike Malleable C2" class="md-nav__link">
      A Deep Dive into Cobalt Strike Malleable C2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2018/threat-gets-a-vote-applying-a-threat-based-approach-to-security-testing/" title="Threat Get's a Vote - Applying a Threat-Based Approach to Security Testing" class="md-nav__link">
      Threat Get's a Vote - Applying a Threat-Based Approach to Security Testing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2018/threat-mitigation-strategies-technical-recommendations-and-info-part-2/" title="Threat Mitagation Strategies - Part 2" class="md-nav__link">
      Threat Mitagation Strategies - Part 2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2018/automating-cobalt-strike-profiles-apache-mod_rewrite-htaccess-files-intelligent-c2-redirection/" title="Automating Cobalt Strike Profiles Apache mod_rewrite htaccess Files for Intelligent C2 Redirection" class="md-nav__link">
      Automating Cobalt Strike Profiles Apache mod_rewrite htaccess Files for Intelligent C2 Redirection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2018/threat-mitigation-strategies-observations-recommendations/" title="Threat Mitagation Strategies - Part 1" class="md-nav__link">
      Threat Mitagation Strategies - Part 1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2018/hostenum-updates-usage/" title="HostEnum - Updates and Usage Guide" class="md-nav__link">
      HostEnum - Updates and Usage Guide
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      2017
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        2017
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2017/metatwin-borrowing-microsoft-metadata-and-digital-signatures-to-hide-binaries/" title="Borrowing Microsoft MetaData and Signatures to Hide Binary Payloads" class="md-nav__link">
      Borrowing Microsoft MetaData and Signatures to Hide Binary Payloads
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2017/install-bloodhound-ubuntu/" title="Install BloodHound on Ubuntu" class="md-nav__link">
      Install BloodHound on Ubuntu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2017/empire-modifying-server-c2-indicators/" title="Empire Modifying Server C2 Indicators" class="md-nav__link">
      Empire Modifying Server C2 Indicators
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2017/invoke-hostenum/" title="Invoke-Hostenum" class="md-nav__link">
      Invoke-Hostenum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2017/leveraging-expired-domains-for-red-team-engagements/" title="Leveraging Expired Domains for Red Team Engagements" class="md-nav__link">
      Leveraging Expired Domains for Red Team Engagements
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4">
    
    <label class="md-nav__link" for="nav-2-4">
      2016
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-4">
        2016
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2016/slack-notifications-for-cobalt-strike/" title="Slack Notifications for Cobalt Strike" class="md-nav__link">
      Slack Notifications for Cobalt Strike
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2016/web-shells-covert-channel/" title="SubShell and TinyShell - Custom Covert Webshells" class="md-nav__link">
      SubShell and TinyShell - Custom Covert Webshells
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2016/new-information-security-red-teaming-blog-threat-express-minis/" title="New Information Security and Red Teaming Blog Threat Express by MINIS" class="md-nav__link">
      New Information Security and Red Teaming Blog Threat Express by MINIS
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Red Teaming
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Red Teaming
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../redteaming/" title="What is Red Teaming" class="md-nav__link">
      What is Red Teaming
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../red_vs_pen_vs_vuln/" title="Red vs Pen vs Vuln" class="md-nav__link">
      Red vs Pen vs Vuln
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../rolesandrelationships/" title="Roles and Relationships" class="md-nav__link">
      Roles and Relationships
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mitre_attack/" title="Red Teaming and MITRE ATT&CK" class="md-nav__link">
      Red Teaming and MITRE ATT&CK
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../definitions/" title="Definitions" class="md-nav__link">
      Definitions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-6" type="checkbox" id="nav-3-6">
    
    <label class="md-nav__link" for="nav-3-6">
      Red Team Planning
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-6">
        Red Team Planning
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../redteamplanning/goalplanning/" title="Goal Planing" class="md-nav__link">
      Goal Planing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../redteamplanning/redteamchecklist/" title="Red Team Checklist" class="md-nav__link">
      Red Team Checklist
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../redteamplanning/roeguide/" title="Red Team ROE Guide" class="md-nav__link">
      Red Team ROE Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../redteamplanning/tradecraft/" title="Tradecraft Guidance" class="md-nav__link">
      Tradecraft Guidance
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-7" type="checkbox" id="nav-3-7" checked>
    
    <label class="md-nav__link" for="nav-3-7">
      Red Team IOCs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-7">
        Red Team IOCs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../tinyshell_ioc/" title="TinyShell IOCs" class="md-nav__link">
      TinyShell IOCs
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        PSEXEC IOCs
      </label>
    
    <a href="./" title="PSEXEC IOCs" class="md-nav__link md-nav__link--active">
      PSEXEC IOCs
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mitre-ttp" class="md-nav__link">
    MITRE TTP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#category" class="md-nav__link">
    Category
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    Description
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-of-presumed-tool-use-during-an-attack" class="md-nav__link">
    Example of Presumed Tool Use During an Attack
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tool-operation-overview" class="md-nav__link">
    Tool Operation Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#information-acquired-from-log" class="md-nav__link">
    Information Acquired from Log
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evidence-that-can-be-confirmed-when-execution-is-successful" class="md-nav__link">
    Evidence That Can Be Confirmed When Execution is Successful
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#main-information-recorded-at-execution" class="md-nav__link">
    Main Information Recorded at Execution
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#source-host" class="md-nav__link">
    Source Host
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#destination-host" class="md-nav__link">
    Destination Host
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usn-journal" class="md-nav__link">
    USN Journal
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefetch" class="md-nav__link">
    Prefetch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interesting-events" class="md-nav__link">
    Interesting Events
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://jpcertcc.github.io/ToolAnalysisResultSheet/" title="JPCert IOCs" class="md-nav__link">
      JPCert IOCs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://digital-forensics.sans.org/media/SANS_Poster_2018_Hunt_Evil_FINAL.pdf" title="SANS Hunt Evil" class="md-nav__link">
      SANS Hunt Evil
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-8" type="checkbox" id="nav-3-8">
    
    <label class="md-nav__link" for="nav-3-8">
      Red Team Resources
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-8">
        Red Team Resources
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cheatsheets/" title="Cheatsheets" class="md-nav__link">
      Cheatsheets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../resources/" title="General Resources" class="md-nav__link">
      General Resources
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../windowsactivedirectory/" title="Attack Active Directory" class="md-nav__link">
      Attack Active Directory
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../videos/videos/" title="Red Team Videos" class="md-nav__link">
      Red Team Videos
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../archive/" title="Post Archive" class="md-nav__link">
      Post Archive
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../contributors/" title="Contributors" class="md-nav__link">
      Contributors
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mitre-ttp" class="md-nav__link">
    MITRE TTP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#category" class="md-nav__link">
    Category
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    Description
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-of-presumed-tool-use-during-an-attack" class="md-nav__link">
    Example of Presumed Tool Use During an Attack
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tool-operation-overview" class="md-nav__link">
    Tool Operation Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#information-acquired-from-log" class="md-nav__link">
    Information Acquired from Log
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evidence-that-can-be-confirmed-when-execution-is-successful" class="md-nav__link">
    Evidence That Can Be Confirmed When Execution is Successful
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#main-information-recorded-at-execution" class="md-nav__link">
    Main Information Recorded at Execution
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#source-host" class="md-nav__link">
    Source Host
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#destination-host" class="md-nav__link">
    Destination Host
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usn-journal" class="md-nav__link">
    USN Journal
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefetch" class="md-nav__link">
    Prefetch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interesting-events" class="md-nav__link">
    Interesting Events
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/threatexpress/edit/master/docs/redteaming/tool_ioc/psexec.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="psexecexe-iocs-and-detection">PsExec.exe IOCs and Detection<a class="headerlink" href="#psexecexe-iocs-and-detection" title="Permanent link">&para;</a></h1>
<p>PsExec.exe is a tool commonly used by system administrators, penetration testers, and threat actors. It is important to understand what indicators a tool may leave behind before using on a Red Team engagement.</p>
<p>This document highlights key IOCs generated when the SysInternals version of PsExec <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/psexec">SysInternals PsExec</a>is used. This is just only procedure of a larger set of techiques. Most variations of this technique share similar IOCs.</p>
<h2 id="mitre-ttp">MITRE TTP<a class="headerlink" href="#mitre-ttp" title="Permanent link">&para;</a></h2>
<p><a href="https://attack.mitre.org/wiki/Technique/T1035">MITRE Technique T1035</a></p>
<table>
<thead>
<tr>
<th>MITRE TTP</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Tatic</strong></td>
<td>Execution</td>
</tr>
<tr>
<td><strong>Technique</strong></td>
<td>Service Execution</td>
</tr>
<tr>
<td><strong>Procedure</strong></td>
<td>Use PsExec.exe to execute commands on a remote Windows system</td>
</tr>
</tbody>
</table>
<h2 id="category">Category<a class="headerlink" href="#category" title="Permanent link">&para;</a></h2>
<p>Command Execution</p>
<h2 id="description">Description<a class="headerlink" href="#description" title="Permanent link">&para;</a></h2>
<p>Executes a command on a remote host.</p>
<h2 id="example-of-presumed-tool-use-during-an-attack">Example of Presumed Tool Use During an Attack<a class="headerlink" href="#example-of-presumed-tool-use-during-an-attack" title="Permanent link">&para;</a></h2>
<p>The tool is used to execute a remote command on hosts and servers in a domain.</p>
<h2 id="tool-operation-overview">Tool Operation Overview<a class="headerlink" href="#tool-operation-overview" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Item</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>OS</td>
<td>Windows</td>
</tr>
<tr>
<td>Belongs to Domain</td>
<td>Not required</td>
</tr>
<tr>
<td>Rights</td>
<td>Standard User / Administrator</td>
</tr>
<tr>
<td>Communication Protocol</td>
<td>- 88/tcp (when executing in a domain environment) - 135/tcp - 445/tcp - Random High Port</td>
</tr>
</tbody>
</table>
<h2 id="information-acquired-from-log">Information Acquired from Log<a class="headerlink" href="#information-acquired-from-log" title="Permanent link">&para;</a></h2>
<p><strong>Standard Settings</strong></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Source host</td>
<td>- A registry value created when the PsExec License Agreement has been agreed to (registry). - Execution history (Prefetch)</td>
</tr>
<tr>
<td>Destination Host</td>
<td>- The fact that the PSEXESVC service has been installed, started, and ended is recorded (system log). - Execution history (Prefetch)</td>
</tr>
</tbody>
</table>
<p><strong>Additional Settings</strong></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Source host</td>
<td>- The fact that the PsExec process was executed and that connection was made to the destination via the network, as well as the command name and argument for a remotely executed command are recorded (audit policy, Sysmon).</td>
</tr>
<tr>
<td>Destination Host</td>
<td>- The fact that PSEXESVC.exe was created and accessed, and that connection was made from the source via the network, as well as the command name and argument for a remotely executed command are recorded (audit policy, Sysmon).</td>
</tr>
<tr>
<td>Packet Capture</td>
<td>- Transmission of PSEXESVC and its output file (-stdin, -stdout, -stderr) with SMB2.</td>
</tr>
</tbody>
</table>
<h2 id="evidence-that-can-be-confirmed-when-execution-is-successful">Evidence That Can Be Confirmed When Execution is Successful<a class="headerlink" href="#evidence-that-can-be-confirmed-when-execution-is-successful" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Source Host</td>
<td>The Event ID 4689 (A process has exited) indicating that psexec.exe was executed and has exited, was recorded in the event log "Security" with the execution result (return value) of "0x0".</td>
</tr>
<tr>
<td>Destination host</td>
<td>In the Event ID: 7045 of the event log "System", the fact that the PSEXESVC service was installed is recorded.</td>
</tr>
</tbody>
</table>
<h2 id="main-information-recorded-at-execution">Main Information Recorded at Execution<a class="headerlink" href="#main-information-recorded-at-execution" title="Permanent link">&para;</a></h2>
<h3 id="source-host">Source Host<a class="headerlink" href="#source-host" title="Permanent link">&para;</a></h3>
<p><strong>Event Log</strong></p>
<table>
<thead>
<tr>
<th>Log</th>
<th>Event ID</th>
<th>Task Category</th>
<th>Event Details</th>
</tr>
</thead>
<tbody>
<tr>
<td>Microsoft-Windows-Sysmon/Operational</td>
<td>1</td>
<td>Process Create (rule: ProcessCreate)</td>
<td><strong>Process Create.</strong> CommandLine:__ Command line of the execution command ([Path to Executable File] [Execution Command]) UtcTime:__ Process execution date and time (UTC) <strong>ProcessGuid/ProcessId:</strong> Process ID <strong>Image:</strong> Path to the executable file (path to the executable file) <strong>User:</strong> Execute as user</td>
</tr>
<tr>
<td>Microsoft-Windows-Sysmon/Operationa</td>
<td>3</td>
<td>Network connection detected (rule: NetworkConnect)</td>
<td><strong>Network Connection Detected:</strong> <strong>Protocol:</strong> Protocol (tcp) <strong>Image:</strong> Path to the executable file (System) <strong>ProcessGuid/ProcessId:</strong> Process ID (4) <strong>User:</strong> Execute as user (NT_AUTHORITY\SYSTEM) <strong>SourceIp/SourceHostname/SourcePort:</strong> Source IP address/Host name/Port number (source host) <strong>DestinationIp/DestinationHostname/DestinationPort:</strong> Destination IP address/Host name/Port number (destination ports: 135 and 445, high port)</td>
</tr>
<tr>
<td>Microsoft-Windows-Sysmon/Operationa</td>
<td>13</td>
<td>Registry value set (rule: RegistryEvent)</td>
<td><strong>Registry value set.</strong> <strong>Image:</strong> Path to the executable file (path to the tool) <strong>ProcessGuid/ProcessId:</strong> Process ID <strong>Details:</strong> Setting value written to the registry (DWORD: 0x00000001) <strong>TargetObject:</strong> Registry value at the write destination (\REGISTRY\USER[User SID]\SOFTWARE\Sysinternals\PsExec\EulaAccepted)</td>
</tr>
<tr>
<td>Security</td>
<td>4689</td>
<td>Process Termination</td>
<td><strong>A process has exited.</strong> <strong>Log Date and Time:</strong> Process terminated date and time (local time)Process Information &gt; Exit Status:__ Process return value (0x0) <strong>Subject &gt; Security ID/Account Name/Account Domain:</strong> SID/Account name/Domain of the user who executed the tool <strong>Process Information &gt; Process Name:</strong> Path to the executable file (path to the tool)</td>
</tr>
</tbody>
</table>
<p><strong>Prefetch</strong></p>
<p>C:\Windows\Prefetch[Executable File Name of Tool]-[RANDOM].pf</p>
<p><strong>Registry</strong></p>
<p>Registry entry</p>
<p>Key: HKEY_USERS[User SID]\SOFTWARE\Sysinternals\PsExec\EulaAccepted
Value: 0x00000001</p>
<h3 id="destination-host">Destination Host<a class="headerlink" href="#destination-host" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Log</th>
<th>Event ID</th>
<th>Task Category</th>
<th>Event Details</th>
</tr>
</thead>
<tbody>
<tr>
<td>Security</td>
<td>5145</td>
<td>Detailed File Share</td>
<td>A network share object was checked to see whether the client can be granted the desired access. <strong>Shared Information &gt; Share Name:</strong> Share name (\*\ADMIN$) <strong>Subject &gt; Security ID/Account Name/Account Domain:</strong> SID/Account name/Domain of the user who executed the tool <strong>Shared Information &gt; Share Path:</strong> Share path (\??\C:\Windows) <strong>Shared Information &gt; Relative Target Name:</strong> Relative target name from the share path (PSEXESVC.exe) <strong>Access Request Information &gt; Access:</strong> Requested privileges (including WriteData or AddFile, and AppendData)</td>
</tr>
<tr>
<td>Microsoft-Windows-Sysmon/Operational</td>
<td>1</td>
<td>Process Create (rule: ProcessCreate)</td>
<td>Process Create. <strong>ParentImage:</strong> Executable file of the parent process (C:\Windows\system32\services.exe) <strong>CommandLine:</strong> Command line of the execution command <strong>ParentCommandLine:</strong> Command line of the parent process (C:\Windows\system32\services.exe) <strong>UtcTime:</strong> Process execution date and time (UTC) <strong>ProcessGuid/ProcessId:</strong> Process IDUser: Execute as user (NT AUTHORITY\SYSTEM) <strong>Image:</strong> Path to the executable file (C:\Windows\PSEXESVC.exe)</td>
</tr>
<tr>
<td>System</td>
<td>7045</td>
<td>A service was installed in the system.</td>
<td>A service was installed. <strong>Service start type:</strong> Operation of trigger that starts the service (demand start) <strong>Service account:</strong> Executing account (LocalSystem) <strong>Service type:</strong> Type of the service to be executed (user mode service) <strong>Service Name:</strong> Name displayed in the service list (PSEXESVC) <strong>Service File Name:</strong> Service executable file (%SystemRoot%\PSEXESVC.exe)</td>
</tr>
<tr>
<td>Security</td>
<td>5145</td>
<td>Detailed File Share</td>
<td>A network share object was checked to see whether the client can be granted the desired access. <strong>Shared Information &gt; Share Name:</strong> Share name (\*\IPC$) <strong>Subject &gt; Security ID/Account Name/Account Domain:</strong> SID/Account name/Domain of the user who executed the tool <strong>Shared Information &gt; Relative Target Name:</strong> Relative target name from the share path (PSEXESVC-[Source Host Name]-[Source Process ID]-[stdin, stdout, stderr])</td>
</tr>
<tr>
<td>Microsoft-Windows-Sysmon/Operational</td>
<td>1</td>
<td>Process Create (rule: ProcessCreate)</td>
<td>Process Create. <strong>ParentProcessGuid/ParentProcessId:</strong> Process ID of the parent process <strong>ParentImage:</strong> Executable file of the parent process (C:\Windows\PSEXESVC.exe) <strong>Image:</strong> Path to the executable file (Path to the executable file that was executed by PsExec) <strong>ParentCommandLine:</strong> Command line of the parent process (C:\Windows\PSEXESVC.exe)<strong>UtcTime:</strong> Process execution date and time (UTC) <strong>ProcessGuid/ProcessId:</strong> Process ID</td>
</tr>
<tr>
<td>System</td>
<td>7036</td>
<td>Service Control Manager</td>
<td>The [Service Name] service entered the [Status] state. <strong>Status:</strong> State after the transition (Stopped) <strong>Service Name:</strong> Target service name (PSEXESVC)</td>
</tr>
<tr>
<td>Security</td>
<td>4689</td>
<td>Process Termination</td>
<td>A process has exited. <strong>Log Date and Time:</strong> Process terminated date and time (local time) <strong>Process Information &gt; Exit Status:</strong> Process return value (0x0) <strong>Process Information &gt; Process Name:</strong> Path to the executable file (C:\Windows\PSEXESVC.exe)</td>
</tr>
<tr>
<td>Security</td>
<td>4674</td>
<td>Sensitive Privilege Use</td>
<td>An operation was attempted on a privileged object. <strong>Subject &gt; Security ID/Account Name/Account Domain:</strong> SID/Account name/Domain of the user who executed the tool <strong>Object &gt; Object Name:</strong> Name of the object to be processed (PSEXESVC) <strong>Object &gt; Object Server:</strong> Service that executed the process (SC Manager) <strong>Requested operation &gt; Privileges:</strong> Requested privilege (DELETE) <strong>Process Information &gt; Process Name:</strong> Path to the executable file (C:\Windows\System32\services.exe) <strong>Object &gt; Object Type:</strong> Type of the object to be processed (SERVICE OBJECT)</td>
</tr>
<tr>
<td>Microsoft-Windows-Sysmon/Operational</td>
<td>11</td>
<td>File created (rule: FileCreate)</td>
<td>File created. <strong>Image:</strong> Path to the executable file (C:\Windows\System32\svchost.exe) <strong>ProcessGuid/ProcessId:</strong> Process IDTarget <strong>Filename:</strong> Created file (C:\Windows\Prefetch\PSEXECSVC.EXE-[Random Number].pf)Creation <strong>UtcTime:</strong> File creation date and time (UTC)</td>
</tr>
</tbody>
</table>
<h3 id="usn-journal">USN Journal<a class="headerlink" href="#usn-journal" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>File Name</th>
<th>Process</th>
</tr>
</thead>
<tbody>
<tr>
<td>PSEXESVC.exe</td>
<td>FILE_CREATE</td>
</tr>
<tr>
<td>PSEXESVC.exe</td>
<td>DATA_EXTEND+FILE_CREATE</td>
</tr>
<tr>
<td>PSEXESVC.exe</td>
<td>CLOSE+DATA_EXTEND+FILE_CREATE</td>
</tr>
<tr>
<td>PSEXESVC.EXE-[RANDOM].pf</td>
<td>FILE_CREATE</td>
</tr>
<tr>
<td>PSEXESVC.EXE-[RANDOM].pf</td>
<td>DATA_EXTEND+FILE_CREATE</td>
</tr>
<tr>
<td>PSEXESVC.EXE-[RANDOM].pf</td>
<td>CLOSE+DATA_EXTEND+FILE_CREATE</td>
</tr>
<tr>
<td>PSEXESVC.exe</td>
<td>CLOSE+FILE_DELETE</td>
</tr>
</tbody>
</table>
<h2 id="prefetch">Prefetch<a class="headerlink" href="#prefetch" title="Permanent link">&para;</a></h2>
<p><code class="codehilite"><span class="nv">C</span>:\<span class="nv">Windows</span>\<span class="nv">Prefetch</span>\<span class="nv">PSEXESVC</span>.<span class="nv">EXE</span><span class="o">-</span>[<span class="k">RANDOM</span>].<span class="nv">pf</span></code></p>
<h2 id="interesting-events">Interesting Events<a class="headerlink" href="#interesting-events" title="Permanent link">&para;</a></h2>
<p><img alt="" src="/images/psexec.png" /></p>
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<p>JPCERT - Research Report Released: Detecting Lateral Movement through Tracking Event Logs <a href="https://blog.jpcert.or.jp/2017/06/1-ae0d.html">https://blog.jpcert.or.jp/2017/06/1-ae0d.html</a></p>
<p>MITRE ATT&amp;CK - Technique T1035 <a href="https://attack.mitre.org/wiki/Technique/T1035">https://attack.mitre.org/wiki/Technique/T1035</a></p>
<p>JPCERT Tool Analysis Results <a href="https://jpcertcc.github.io/ToolAnalysisResultSheet/">https://jpcertcc.github.io/ToolAnalysisResultSheet/</a></p>
<p>JPCERT Tool Analysis Results - PsExec <a href="https://jpcertcc.github.io/ToolAnalysisResultSheet/details/PsExec.htm">https://jpcertcc.github.io/ToolAnalysisResultSheet/details/PsExec.htm</a></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../tinyshell_ioc/" title="TinyShell IOCs" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                TinyShell IOCs
              </span>
            </div>
          </a>
        
        
          <a href="../../cheatsheets/" title="Cheatsheets" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Cheatsheets
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Â© 2019 Threatexpress
          </div>
        
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/threatexpress" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/joevest" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.ac79c3b0.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
        <script src="https://platform.twitter.com/widgets.js"></script>
      
        <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
      
        <script src="../../../js/extra.js"></script>
      
    
  </body>
</html>