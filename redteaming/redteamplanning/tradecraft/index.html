



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Threatexpress Blog">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.2">
    
    
      
        <title>Tradecraft Guidance - Threatexpress</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.982221ab.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../../assets/javascripts/modernizr.1f0bcf2b.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="black" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#red-team-tradecraft-and-ttp-guidance" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../.." title="Threatexpress" class="md-header-nav__button md-logo">
          
            <img src="../../../img/threatexpress_logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Threatexpress
            </span>
            <span class="md-header-nav__topic">
              Tradecraft Guidance
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/threatexpress/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    threatexpress/threatexpress
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../.." title="Threatexpress" class="md-nav__button md-logo">
      
        <img src="../../../img/threatexpress_logo.png" width="48" height="48">
      
    </a>
    Threatexpress
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/threatexpress/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    threatexpress/threatexpress
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://redteam.guide" title="REDTEAM.GUIDE" class="md-nav__link">
      REDTEAM.GUIDE
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Posts
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Posts
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1">
    
    <label class="md-nav__link" for="nav-3-1">
      2020
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        2020
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2020/threatbox-standard-attack-platform/" title="ThreatBox - Standard Attack Platform" class="md-nav__link">
      ThreatBox - Standard Attack Platform
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2020/red-team-development-and-operations/" title="Red Team Development and Operations" class="md-nav__link">
      Red Team Development and Operations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      2019
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        2019
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2019/event-data-collector/" title="Event Data Collector" class="md-nav__link">
      Event Data Collector
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2019/c2-agent-comparison/" title="C2 Agent Comparison" class="md-nav__link">
      C2 Agent Comparison
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2019/git-clone-entire-org/" title="Git clone all organizational repos" class="md-nav__link">
      Git clone all organizational repos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2019/penetration-testing-pasties/" title="Penetration Testing Pasties" class="md-nav__link">
      Penetration Testing Pasties
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      2018
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        2018
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2018/a-deep-dive-into-cobalt-strike-malleable-c2/" title="A Deep Dive into Cobalt Strike Malleable C2" class="md-nav__link">
      A Deep Dive into Cobalt Strike Malleable C2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2018/threat-gets-a-vote-applying-a-threat-based-approach-to-security-testing/" title="Threat Get's a Vote - Applying a Threat-Based Approach to Security Testing" class="md-nav__link">
      Threat Get's a Vote - Applying a Threat-Based Approach to Security Testing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2018/threat-mitigation-strategies-technical-recommendations-and-info-part-2/" title="Threat Mitagation Strategies - Part 2" class="md-nav__link">
      Threat Mitagation Strategies - Part 2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2018/automating-cobalt-strike-profiles-apache-mod_rewrite-htaccess-files-intelligent-c2-redirection/" title="Automating Cobalt Strike Profiles Apache mod_rewrite htaccess Files for Intelligent C2 Redirection" class="md-nav__link">
      Automating Cobalt Strike Profiles Apache mod_rewrite htaccess Files for Intelligent C2 Redirection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2018/threat-mitigation-strategies-observations-recommendations/" title="Threat Mitagation Strategies - Part 1" class="md-nav__link">
      Threat Mitagation Strategies - Part 1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2018/hostenum-updates-usage/" title="HostEnum - Updates and Usage Guide" class="md-nav__link">
      HostEnum - Updates and Usage Guide
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4">
    
    <label class="md-nav__link" for="nav-3-4">
      2017
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-4">
        2017
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2017/metatwin-borrowing-microsoft-metadata-and-digital-signatures-to-hide-binaries/" title="Borrowing Microsoft MetaData and Signatures to Hide Binary Payloads" class="md-nav__link">
      Borrowing Microsoft MetaData and Signatures to Hide Binary Payloads
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2017/install-bloodhound-ubuntu/" title="Install BloodHound on Ubuntu" class="md-nav__link">
      Install BloodHound on Ubuntu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2017/empire-modifying-server-c2-indicators/" title="Empire Modifying Server C2 Indicators" class="md-nav__link">
      Empire Modifying Server C2 Indicators
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2017/invoke-hostenum/" title="Invoke-Hostenum" class="md-nav__link">
      Invoke-Hostenum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2017/leveraging-expired-domains-for-red-team-engagements/" title="Leveraging Expired Domains for Red Team Engagements" class="md-nav__link">
      Leveraging Expired Domains for Red Team Engagements
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5" type="checkbox" id="nav-3-5">
    
    <label class="md-nav__link" for="nav-3-5">
      2016
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-5">
        2016
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2016/slack-notifications-for-cobalt-strike/" title="Slack Notifications for Cobalt Strike" class="md-nav__link">
      Slack Notifications for Cobalt Strike
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2016/web-shells-covert-channel/" title="SubShell and TinyShell - Custom Covert Webshells" class="md-nav__link">
      SubShell and TinyShell - Custom Covert Webshells
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../blogs/2016/new-information-security-red-teaming-blog-threat-express-minis/" title="New Information Security and Red Teaming Blog Threat Express by MINIS" class="md-nav__link">
      New Information Security and Red Teaming Blog Threat Express by MINIS
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Red Teaming
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Red Teaming
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../redteaming/" title="What is Red Teaming" class="md-nav__link">
      What is Red Teaming
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../red_vs_pen_vs_vuln/" title="Red vs Pen vs Vuln" class="md-nav__link">
      Red vs Pen vs Vuln
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../rolesandrelationships/" title="Roles and Relationships" class="md-nav__link">
      Roles and Relationships
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mitre_attack/" title="Red Teaming and MITRE ATT&CK" class="md-nav__link">
      Red Teaming and MITRE ATT&CK
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../definitions/" title="Definitions" class="md-nav__link">
      Definitions
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-6" type="checkbox" id="nav-4-6" checked>
    
    <label class="md-nav__link" for="nav-4-6">
      Red Team Planning
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-6">
        Red Team Planning
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../goalplanning/" title="Goal Planing" class="md-nav__link">
      Goal Planing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../redteamchecklist/" title="Red Team Checklist" class="md-nav__link">
      Red Team Checklist
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../roeguide/" title="Red Team ROE Guide" class="md-nav__link">
      Red Team ROE Guide
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Tradecraft Guidance
      </label>
    
    <a href="./" title="Tradecraft Guidance" class="md-nav__link md-nav__link--active">
      Tradecraft Guidance
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#do-log-all-significant-actions" title="DO: LOG ALL SIGNIFICANT ACTIONS" class="md-nav__link">
    DO: LOG ALL SIGNIFICANT ACTIONS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#do-consult-with-peers" title="DO: CONSULT WITH PEERS" class="md-nav__link">
    DO: CONSULT WITH PEERS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#do-understand-the-tools-and-technologies-used" title="DO: UNDERSTAND THE TOOLS AND TECHNOLOGIES USED" class="md-nav__link">
    DO: UNDERSTAND THE TOOLS AND TECHNOLOGIES USED
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#do-perform-situational-awareness" title="DO: PERFORM SITUATIONAL AWARENESS" class="md-nav__link">
    DO: PERFORM SITUATIONAL AWARENESS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#do-minimize-callback-c2-volume" title="DO: MINIMIZE CALLBACK (C2) VOLUME" class="md-nav__link">
    DO: MINIMIZE CALLBACK (C2) VOLUME
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dont-use-untested-tools-on-a-target-system" title="DON’T: USE UNTESTED TOOLS ON A TARGET SYSTEM" class="md-nav__link">
    DON’T: USE UNTESTED TOOLS ON A TARGET SYSTEM
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dont-use-unencrypted-channels-for-c2" title="DON’T: USE UNENCRYPTED CHANNELS FOR C2" class="md-nav__link">
    DON’T: USE UNENCRYPTED CHANNELS FOR C2
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dont-attempt-to-exploit-or-attack-unencrypted-websites" title="DON’T: ATTEMPT TO EXPLOIT OR ATTACK UNENCRYPTED WEBSITES" class="md-nav__link">
    DON’T: ATTEMPT TO EXPLOIT OR ATTACK UNENCRYPTED WEBSITES
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dont-execute-from-non-executable-locations" title="DON’T: EXECUTE FROM NON-EXECUTABLE LOCATIONS" class="md-nav__link">
    DON’T: EXECUTE FROM NON-EXECUTABLE LOCATIONS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dont-use-binaries-for-initial-capabilities" title="DON’T: USE BINARIES FOR INITIAL CAPABILITIES" class="md-nav__link">
    DON’T: USE BINARIES FOR INITIAL CAPABILITIES
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dont-download-restricted-datasets" title="DON’T: DOWNLOAD RESTRICTED DATASETS" class="md-nav__link">
    DON’T: DOWNLOAD RESTRICTED DATASETS
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7">
    
    <label class="md-nav__link" for="nav-4-7">
      Red Team IOCs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        Red Team IOCs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tool_ioc/tinyshell_ioc/" title="TinyShell IOCs" class="md-nav__link">
      TinyShell IOCs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tool_ioc/psexec/" title="PSEXEC IOCs" class="md-nav__link">
      PSEXEC IOCs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://jpcertcc.github.io/ToolAnalysisResultSheet/" title="JPCert IOCs" class="md-nav__link">
      JPCert IOCs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://digital-forensics.sans.org/media/SANS_Poster_2018_Hunt_Evil_FINAL.pdf" title="SANS Hunt Evil" class="md-nav__link">
      SANS Hunt Evil
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      Red Team Resources
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        Red Team Resources
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cheatsheets/" title="Cheatsheets" class="md-nav__link">
      Cheatsheets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../resources/" title="General Resources" class="md-nav__link">
      General Resources
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../windowsactivedirectory/" title="Attack Active Directory" class="md-nav__link">
      Attack Active Directory
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../videos/videos/" title="Red Team Videos" class="md-nav__link">
      Red Team Videos
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../archive/" title="Post Archive" class="md-nav__link">
      Post Archive
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../contributors/" title="Contributors" class="md-nav__link">
      Contributors
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#do-log-all-significant-actions" title="DO: LOG ALL SIGNIFICANT ACTIONS" class="md-nav__link">
    DO: LOG ALL SIGNIFICANT ACTIONS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#do-consult-with-peers" title="DO: CONSULT WITH PEERS" class="md-nav__link">
    DO: CONSULT WITH PEERS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#do-understand-the-tools-and-technologies-used" title="DO: UNDERSTAND THE TOOLS AND TECHNOLOGIES USED" class="md-nav__link">
    DO: UNDERSTAND THE TOOLS AND TECHNOLOGIES USED
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#do-perform-situational-awareness" title="DO: PERFORM SITUATIONAL AWARENESS" class="md-nav__link">
    DO: PERFORM SITUATIONAL AWARENESS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#do-minimize-callback-c2-volume" title="DO: MINIMIZE CALLBACK (C2) VOLUME" class="md-nav__link">
    DO: MINIMIZE CALLBACK (C2) VOLUME
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dont-use-untested-tools-on-a-target-system" title="DON’T: USE UNTESTED TOOLS ON A TARGET SYSTEM" class="md-nav__link">
    DON’T: USE UNTESTED TOOLS ON A TARGET SYSTEM
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dont-use-unencrypted-channels-for-c2" title="DON’T: USE UNENCRYPTED CHANNELS FOR C2" class="md-nav__link">
    DON’T: USE UNENCRYPTED CHANNELS FOR C2
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dont-attempt-to-exploit-or-attack-unencrypted-websites" title="DON’T: ATTEMPT TO EXPLOIT OR ATTACK UNENCRYPTED WEBSITES" class="md-nav__link">
    DON’T: ATTEMPT TO EXPLOIT OR ATTACK UNENCRYPTED WEBSITES
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dont-execute-from-non-executable-locations" title="DON’T: EXECUTE FROM NON-EXECUTABLE LOCATIONS" class="md-nav__link">
    DON’T: EXECUTE FROM NON-EXECUTABLE LOCATIONS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dont-use-binaries-for-initial-capabilities" title="DON’T: USE BINARIES FOR INITIAL CAPABILITIES" class="md-nav__link">
    DON’T: USE BINARIES FOR INITIAL CAPABILITIES
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dont-download-restricted-datasets" title="DON’T: DOWNLOAD RESTRICTED DATASETS" class="md-nav__link">
    DON’T: DOWNLOAD RESTRICTED DATASETS
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/threatexpress/edit/master/docs/redteaming/redteamplanning/tradecraft.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="red-team-tradecraft-and-ttp-guidance">Red Team Tradecraft and TTP Guidance<a class="headerlink" href="#red-team-tradecraft-and-ttp-guidance" title="Permanent link">&para;</a></h1>
<p>This template should be used to define the overall guidance on Red Team Tradecraft and TTPs. Every Red Team should have a guidance document. Keep this document updated and distributed to all Red Team members. This document should be used to guide Red Team actions of all Red Team operators on all engagements. Exceptions to these rules can (and will) be made based on specific Rules of Engagement (ROE) or decision made by Red Team leads during an engagement. Exceptions should be documented as part of the engagement logging. It is important to use and follow this document to maintain a high-quality professional Red Team.</p>
<p>Add custom or specific Tradecraft and TTP Guidance to this document as needed. This include specific or customs tools that should be used for various tasks, C2, enumeration, etc</p>
<p>Guidance</p>
<table>
<thead>
<tr>
<th align="center">Do</th>
<th align="center">Don't</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Log all significant events</td>
<td align="center">Use untested tools on a target system</td>
</tr>
<tr>
<td align="center">Consult with peers</td>
<td align="center">Use unencrypted channels for C2</td>
</tr>
<tr>
<td align="center">Understand tools and technology used</td>
<td align="center">Attempt to exploit or attack unencrypted websites</td>
</tr>
<tr>
<td align="center">Perform situational awareness</td>
<td align="center">Execute from non-executable locations</td>
</tr>
<tr>
<td align="center">Minimize callback (C2) volume</td>
<td align="center">Download restricted datasets</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">Use binaries for initial access</td>
</tr>
</tbody>
</table>
<h2 id="do-log-all-significant-actions">DO: LOG ALL SIGNIFICANT ACTIONS<a class="headerlink" href="#do-log-all-significant-actions" title="Permanent link">&para;</a></h2>
<p>(SUCCESSES AND FAILURES)
Log, log and log some more! Screenshot all significant actions including successful and failed attempts. One of the most important aspects of the Red Team engagement is the collection of data (a.k.a. logs). It is common that an inexperienced team completes an engagement with subpar documentation. Many actions are not fully captured, some actions are never captured, and often key failures are ignored. Each action performed provides value to the target as well as the target defenders. Incomplete logs prevent the Red Team from providing a complete and accurate depiction of the actions, obstacles, and defensive strengths and weaknesses of the target (i.e. mission failure).
There are several methods to ensure logs are appropriately captured and stored:
- Automated logging of the terminal: All terminal actions logged, timestamped and stored to a predefined location.
- Tool logs: Most commercial tools have some capability to log actions and produce a raw and/or final report.
- Custom tools logs: If you write a custom tool/script, it should output a log of actions and results.
- Operator logs: By far this is the most important log. A log may show the action performed and the result; however, only the operator can accurately note the way the action was performed, what lead them to the decision, and their interpretation of the result.
- Screenshots: Terminal logs are great for the operator and even better as supporting artifacts; however, they may mean nothing to senior level executives (and even some IT professionals). Screenshots before, during, and following the execution of an action hold much more weight than a terminal log, tool log, or operator log (often if may just be a screenshot of the terminal during execution).</p>
<h2 id="do-consult-with-peers">DO: CONSULT WITH PEERS<a class="headerlink" href="#do-consult-with-peers" title="Permanent link">&para;</a></h2>
<p>No matter how long you have been performing IT or security, consult your peers before taking action. This is especially true during exploitation and command and control setup.
Simple mistakes often lead to Red Team discovery too early in the engagement.
Look at the command below. The command will be run as part of a tool written to provide general SA on a Linux system. What should the output look like?</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>netstat –antb
</pre></div>
</td></tr></table>

<p>The command above is a netstat command that can be executed on a Windows host. Linux does not have the "b" option and produces an "invalid option" response.
Think about it</p>
<ul>
<li>Have you ever typed ifconfig instead of ipconfig? </li>
<li>Have you ever typed rm * in the wrong directory?</li>
<li>Have you ever entered credentials only to discover they were "fat fingered" (after access error)?
While these are oversimplifications, they represent the need for peer review on tools, C2, setup, execution, and even clean up.</li>
</ul>
<h2 id="do-understand-the-tools-and-technologies-used">DO: UNDERSTAND THE TOOLS AND TECHNOLOGIES USED<a class="headerlink" href="#do-understand-the-tools-and-technologies-used" title="Permanent link">&para;</a></h2>
<p>Understand the underlying technology of a tool or technique before using it on an event.
Know how the tool or technique interacts with a target, what network traffic it may generate, and what traces it may leave behind.
Knowing what a tool does is only one-third of the equation. What does that mean exactly? Let’s quickly look at a few questions and an example.</p>
<ul>
<li>What artifacts does the tool leave behind? - Are any files modified during execution?</li>
<li>Are there tales in the network traffic?</li>
</ul>
<p>Now let’s look at psexec (a commonly used tool, but not a recommended tool for Red Teaming a remote system)
Depending on how psexec is executed it:</p>
<ul>
<li>Copies a service file to the remote system</li>
<li>Enters a service key into the registry</li>
<li>Creates a prefetch file</li>
<li>Creates an entry in the Application Compatibility Cache - Creates a login event</li>
<li>Creates a profile folder for the remote user</li>
<li>Attempts to remove service file and key when exiting (not always successful)</li>
</ul>
<p>What happens when using the –e option? –s option? How does this differ from psexec for PowerShell?
Psexec is not a bad tool, and Red Team operators will use it. But... it is important to understand the IOCs generated by a tool. Getting caught due to a lack of tool understanding is not something any Red Team operators wants to experience.</p>
<h2 id="do-perform-situational-awareness">DO: PERFORM SITUATIONAL AWARENESS<a class="headerlink" href="#do-perform-situational-awareness" title="Permanent link">&para;</a></h2>
<p>After gaining access to a remote system perform situational awareness before moving on.</p>
<ul>
<li>Understand the environment you are in (Is the target in scope?)</li>
<li>What protections exist on the system or network?</li>
<li>What are the risks of being caught and what attack paths does the system provide? - Are there pre-established connections to other network resources?</li>
<li>Who is into the system?</li>
<li>Who has recently logged into the system?</li>
</ul>
<h2 id="do-minimize-callback-c2-volume">DO: MINIMIZE CALLBACK (C2) VOLUME<a class="headerlink" href="#do-minimize-callback-c2-volume" title="Permanent link">&para;</a></h2>
<p>Unless a Host Based protection mechanism is triggered, it is more likely to be discovered or
caught by a defenders recognition and/or analysis of traffic on the network. To avoid early detection, it is always good tradecraft to limit the amount of traffic generated during the engagement.
There are several general concepts that, if followed, increase the success of the engagement while decreasing the chances of being discovered:</p>
<ul>
<li>Keep traffic internal to a network: One of the most common issues, and one you should always attempt to change, are the limited number of sensors inside a network. Most network protections are currently applied at the boundary.</li>
<li>Pivot command and control traffic to a minimal number of outbound sources: Maintain at least two outbound sources for C2 redundancy; however, only use one for operations (considered an interactive tier). The second (a long or short haul tier) is dormant or extremely slow to be used as a backup if/when the primary is discovered.</li>
</ul>
<h2 id="dont-use-untested-tools-on-a-target-system">DON’T: USE UNTESTED TOOLS ON A TARGET SYSTEM<a class="headerlink" href="#dont-use-untested-tools-on-a-target-system" title="Permanent link">&para;</a></h2>
<p>Before using a new tool (script, application, binary, process, etc.) on a target system, it must be tested, undergo an internal vetting process and be added to an official toolset.
Does the tool have negative impacts on specific versions of an OS?</p>
<ul>
<li>Works fine on Windows 7 but causes system error in Windows 8?</li>
<li>Do you know if/what additional actions the tool performs?</li>
<li>Tool creates a covert channel for use inside the network.</li>
<li>This tool creates a private tunnel between host on a virtual interface; however, this
creates a network conflict</li>
<li>Ex: target net: 10.10.2.0/24, covert channel net: 10.10.2.0/24 - Hint: Don’t use these!
Does the tool try to call home for updates?</li>
<li>At start or during a specific operation, the tool tries to poll home for updates</li>
<li>This can trigger defensive alerts identifying unauthorized persons or software on the network</li>
</ul>
<p>Does the tool attempt to run as a specific user or, worse, create a user/group? Keep these questions in mind before executing untested or unknown tools.</p>
<h2 id="dont-use-unencrypted-channels-for-c2">DON’T: USE UNENCRYPTED CHANNELS FOR C2<a class="headerlink" href="#dont-use-unencrypted-channels-for-c2" title="Permanent link">&para;</a></h2>
<p>Command and control data exiting the network must be encrypted. Clear text data, such as
uploading a binary, issuing an operating system command or using a web shell will be detected by an IDS or other network defense if in clear text. It has become common for IPS/IDS to detect specific strings discovered in clear text traffic.
For example: "C:\Windows\System32" has become a common trigger for investigation.
Some defenders have even gone the extra mile in legitimizing a potential threat. Assume the defender uses a remote administration tool on a regular basis. Ignoring recommendation, this traffic is unencrypted. Rather than alert each time the tool is used legitimately, the alert is configured to look for inconsistencies in the text. For example: most attackers are accustomed to typing lowercase commands in windows. The defender ignores "C:\Windows\System32" but alerts on "c:\windows\system32"
Encryption of internal C2 traffic depends upon several different factors:</p>
<ul>
<li>Are there sensors inside the network?</li>
<li>Are there other encrypted communications occurring between target systems?</li>
<li>Would encrypted traffic stand-out more than unencrypted traffic?
Internal encryption is another example of where peers should be consulted to determine the best course of action before deploying C2 further into a network.</li>
</ul>
<h2 id="dont-attempt-to-exploit-or-attack-unencrypted-websites">DON’T: ATTEMPT TO EXPLOIT OR ATTACK UNENCRYPTED WEBSITES<a class="headerlink" href="#dont-attempt-to-exploit-or-attack-unencrypted-websites" title="Permanent link">&para;</a></h2>
<p>As tempting as it may be, do not attack unencrypted websites. Simple attacks can trigger IDS. Always know your target IP space. There are likely several websites available for review. Proper reconnaissance and/or coordination should have discovered each. Create a list of sites in your target log. Include IP, URLs, an educated guess at the function, ports, protocols, etc.</p>
<p>Important Note!
Prior to performing any exploitation and attacks against a web server, refer to your rules of engagement and fully understand:</p>
<ul>
<li>Who actually owns the website?</li>
<li>Who owns the system where the website is hosted? Who owns the backend application?</li>
<li>Have proper approvals been obtained to test?</li>
</ul>
<h2 id="dont-execute-from-non-executable-locations">DON’T: EXECUTE FROM NON-EXECUTABLE LOCATIONS<a class="headerlink" href="#dont-execute-from-non-executable-locations" title="Permanent link">&para;</a></h2>
<p>Execution on a Windows environment must occur in a location typical of windows. Executable locations such as c:\programdata, c:\progam files, c:\windows are common. Execution for locations such as c:\windows\temp should never occur.</p>
<h2 id="dont-use-binaries-for-initial-capabilities">DON’T: USE BINARIES FOR INITIAL CAPABILITIES<a class="headerlink" href="#dont-use-binaries-for-initial-capabilities" title="Permanent link">&para;</a></h2>
<p>As a general rule, do not drop binaries on the system. Use built-in commands, such as PowerShell, to achieve your goals first. This is not always possible and binaries may be required; however, binaries must be vetted, obfuscated and tested against detection before use.
Ensure all other "Do’s and Don’ts" are met for all binaries. Consult a senior operator before dropping any binary.</p>
<h2 id="dont-download-restricted-datasets">DON’T: DOWNLOAD RESTRICTED DATASETS<a class="headerlink" href="#dont-download-restricted-datasets" title="Permanent link">&para;</a></h2>
<p>NEVER download (or remove from the target network) any PII, HIPPA, PCI, or other restricted
datasets. A good rule of thumb is to annotate the type of data, location, access method, and level of access of restricted data in the log. Ensure the log notes include a reference to the type of data discovered for quick reference. Take a screenshot of the displayed filename and location (assuming the file name has no restricted data included). If the operator can screenshot a portion of the dataset without capturing the restricted data, they may do so for proof-of-access; however, DO NOT take screenshots of the data itself!</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../roeguide/" title="Red Team ROE Guide" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Red Team ROE Guide
              </span>
            </div>
          </a>
        
        
          <a href="../../tool_ioc/tinyshell_ioc/" title="TinyShell IOCs" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                TinyShell IOCs
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            © 2019 Threatexpress
          </div>
        
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/threatexpress" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/joevest" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.d9aa80ab.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
        <script src="https://platform.twitter.com/widgets.js"></script>
      
        <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
      
        <script src="../../../js/extra.js"></script>
      
    
  </body>
</html>